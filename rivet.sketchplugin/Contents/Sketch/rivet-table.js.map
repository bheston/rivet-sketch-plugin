{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/common/MochaJSDelegate.js","webpack://exports/./src/common/coerce.js","webpack://exports/./src/common/context.js","webpack://exports/./src/common/first-mouse-acceptor.js","webpack://exports/./src/common/logger.js","webpack://exports/./src/common/metadata.js","webpack://exports/./src/common/panel.js","webpack://exports/./src/common/search.js","webpack://exports/./src/common/sketch.js","webpack://exports/./src/common/util.js","webpack://exports/./src/rivet-table.js"],"names":["selectorHandlerDict","uniqueClassName","NSUUID","UUID","UUIDString","delegateClassDesc","MOClassDescription","allocateDescriptionForClassWithName_superclass_","NSObject","registerClass","handlers","setHandlerForSelector","selectorString","func","handlerHasBeenSet","selector","NSSelectorFromString","dynamicHandler","functionToCall","apply","arguments","args","regex","exec","push","length","dynamicFunction","eval","join","addInstanceMethodWithSelector_function_","removeHandlerForSelector","getHandlerForSelector","getAllHandlers","getClass","NSClassFromString","getClassInstance","new","coerceJS","value","class","coerceString","coerceObject","coerceArray","coerceNumber","Array","isArray","map","newObj","key","str","number","coerceBool","array","result","$","forEach","item","dict","allKeys","context","currentContext","init","logger","info","run","document","complete","current","getCommandName","command","name","getPluginRoot","pluginRoot","scriptPath","stringByDeletingLastPathComponent","displayDialog","body","log","app","NSApplication","sharedApplication","displayDialog_withTitle","tryCurrent","createCocoaObject","methods","superclass","classDesc","addInstanceMethodWithSelector_function","addFirstMouseAcceptor","webView","contentView","button","evt","removeFromSuperview","sendEvent","NSButton","setIdentifier","setTransparent","setTranslatesAutoresizingMaskIntoConstraints","addSubview","views","addConstraints","NSLayoutConstraint","constraintsWithVisualFormat_options_metrics_views","NSLayoutFormatDirectionLeadingToTrailing","constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant","NSLayoutAttributeTop","NSLayoutRelationEqual","_levels","DEBUG","INFO","WARN","ERROR","_logLevel","_log","level","message","data","now","Date","prefix","levelString","dataString","JSON","stringify","toISOString","_debug","_info","_warn","_error","_setLevel","debug","warn","error","levels","setLevel","metadata","KEY","_getUIMetadata","mutableUIMetadata","_getConfigs","container","configsData","valueForKey_onLayer","objectForKey","parse","_setConfigs","newConfigs","replace","undefined","extend","timestamp","getTime","setValue_forKey_onLayer","setObject_forKey","saveDoc","sketch","addShape","currentPage","addLayers","removeLayer","_removeConfigs","getConfigs","setConfigs","removeConfigs","testMetadata","selectedLayers","selection","selectedCount","count","layer","prop1","prop2","c","prop3","panel","TITLE_BG_COLOR","NSColor","colorWithRed_green_blue_alpha","coscript","setShouldKeepAround","_createPanel","options","self","threadDictionary","url","width","height","floatWindow","hiddenClose","callback","remote","encodeURI","frame","NSMakeRect","contentBgColor","identifier","NSThread","mainThread","COScript","currentCOScript","setShouldKeepAround_","Panel","NSPanel","alloc","setTitleVisibility","NSWindowTitleHidden","setTitlebarAppearsTransparent","standardWindowButton","NSWindowCloseButton","setHidden","NSWindowMiniaturizeButton","NSWindowZoomButton","setFrame_display","setBackgroundColor","setWorksWhenModal","becomeKeyWindow","NSFloatingWindowLevel","WebView","initWithFrame","windowObject","windowScriptObject","setWantsLayer","setFrame","setMainFrameURL_","delegate","MochaJSDelegate","webFrame","MDAction","DOMReady","evaluateWebScript","request","NSURL","URLWithString","mainFrameURL","fragment","decodeURI","valueForKey","e","MD","Importer","convertSvgToSymbol","openURL","Typography","applyTypographyStyles","orderOut","nil","NSApp","stopModal","close","point","currentEvent","locationInWindow","y","NSHeight","x","setFrameLoadDelegate_","center","makeKeyAndOrderFront","closeButton","setCOSJSTargetFunction","sender","removeObjectForKey","wantsStop","setAction","titlebarView","superview","titlebarViewController","view","titlebarContainerView","setFrameOrigin","NSMakePoint","setFrameSize","NSMakeSize","runModalForWindow","createPanel","search","findLayersMatchingPredicate_inContainer_filterByType","predicate","layerType","doc","scope","MSPage","pages","filteredArrayUsingPredicate","MSArtboardGroup","className","artboards","filteredArray","NSArray","loopPages","objectEnumerator","page","nextObject","arrayByAddingObjectsFromArray","MSSymbolMaster","documentData","allSymbols","children","findPagesByName","pageName","NSPredicate","predicateWithFormat","findSymbolsByID","id","findSymbolsByName","findSymbolsByNameBegin","findLayerStyleByName","styleName","styles","layerStyles","objects","i","objectAtIndex","findTextStyleByName","textStyles","layerTextStyles","findTextStyleByID","styleID","objectID","is","theClass","klass","addGroup","MSLayerGroup","MSShapeGroup","shapeWithRect","addText","string","text","MSTextLayer","setStringValue","parentGroup","moveLayerAbove","parent","lower","upper","moveToLayer_beforeLayer","setAsMask","hasClippingMask","clippingMaskMode","setRadius","radius","layers","firstObject","setCornerRadiusFromComponents","getGroupRect","group","rect","groupBoundsForLayers","Math","round","maxX","maxY","setX","setY","setWidth","setHeight","getRect","setConstrainProportions","val","OVERRIDE_NULL_SYMBOL","updateOverrides","instance","values","existingOverrides","overrides","NSMutableDictionary","dictionary","mutableOverrides","dictionaryWithDictionary","idValuePairs","_setupOverrides","instanceOrMaster","symbolMaster","isVisible","isLocked","fieldNames","Object","keys","layerValues","layerInstanceOrMaster","layerOverrides","symbol","symbolID","otherOverrides","propertyCount","j","fieldName","describeOverrides","_describeLayerOverrides","indent","ret","symbolId","child","MSSymbolInstance","layerDesc","toNopPath","toJSString","toHTMLEncode","emojiToEntities","emojiRanges","RegExp","match","encodeURIComponent","split","h","parseInt","toString","toSlug","toLowerCase","String","toJSNumber","Number","pointToJSON","parseFloat","rectToJSON","referenceRect","colorToJSON","color","r","red","g","green","b","blue","a","alpha","immutableModelObject","stringValueWithAlpha","toHex","toFixed","colorStopToJSON","colorStop","position","gradientToJSON","gradient","stopsData","stop","stopIter","stops","type","GradientTypes","gradientType","from","to","colorStops","shadowToJSON","shadow","MSStyleShadow","offsetX","offsetY","blurRadius","spread","hexToColor","hex","hexRgb","MSColor","getRadius","MSRectangleShape","fixedRadius","getBorders","style","bordersData","border","borderIter","borders","isEnabled","fillType","FillTypes","borderData","BorderPositions","thickness","getFills","fillsData","fill","fillIter","fills","fillData","getShadows","shadowsData","shadowIter","shadows","innerShadows","shaxdow","getOpacity","contextSettings","opacity","getStyleName","sharedStyle","setColor","replacementProperty","textColor","updateContext","NSDocumentController","sharedDocumentController","currentDocument","nsurl","NSWorkspace","sharedWorkspace","target","debugObject","obj","ctx","Table","generateTable","BORDER_WIDTH","headers","columns","widths","metas","props","table","tableMask","tableGroup","tableToReplace","layerForPositioning","rowCount","pageOrArtboard","currentArtboard","_generateTable","initialData","sel","selCount","_tablePanel","_parseDataFromPanel","_getTableSize","_createGroup","_storeConfig","_addPagination","_addTableBase","_makeCols","_addGroupsToTable","_positionOrReplaceTable","_parseDataFromString","sep","cells","setName","hasPagination","newSymbolInstance","maskStyle","setSharedStyle","maskRect","tableRect","addLayer","metricSymbol","iconSymbol","hasCheckboxes","selectSymbol","tableWidth","header","isIcon","uniqueValues","Set","delete","size","has","overrideValues","hasDefaultValues","columnRect","select_byExpandingSelection","layerRect","tableGroupRect"],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AAEe,yEAAUA,mBAAV,EAA+B;AAC7C,MAAIC,eAAe,GAAG,kCAAkCC,MAAM,CAACC,IAAP,GAAcC,UAAd,EAAxD;AAEA,MAAIC,iBAAiB,GAAGC,kBAAkB,CAACC,+CAAnB,CAAmEN,eAAnE,EAAoFO,QAApF,CAAxB;AAEAH,mBAAiB,CAACI,aAAlB,GAL6C,CAO7C;;AAEA,MAAIC,QAAQ,GAAG,EAAf,CAT6C,CAW7C;;AAEA,OAAKC,qBAAL,GAA6B,UAAUC,cAAV,EAA0BC,IAA1B,EAAgC;AAC5D,QAAIC,iBAAiB,GAAIF,cAAc,IAAIF,QAA3C;AACA,QAAIK,QAAQ,GAAGC,oBAAoB,CAACJ,cAAD,CAAnC;AAEAF,YAAQ,CAACE,cAAD,CAAR,GAA2BC,IAA3B;;AAEA,QAAI,CAACC,iBAAL,EAAwB;AACvB;;;;;AAOA,UAAIG,cAAc,GAAG,SAAjBA,cAAiB,GAAY;AAChC,YAAIC,cAAc,GAAGR,QAAQ,CAACE,cAAD,CAA7B;AAEA,YAAI,CAACM,cAAL,EAAqB;AAErB,eAAOA,cAAc,CAACC,KAAf,CAAqBd,iBAArB,EAAwCe,SAAxC,CAAP;AACA,OAND;;AAQA,UAAIC,IAAI,GAAG,EAAX;AAAA,UAAeC,KAAK,GAAG,IAAvB;;AACA,aAAOA,KAAK,CAACC,IAAN,CAAWX,cAAX,CAAP,EAAmC;AAClCS,YAAI,CAACG,IAAL,CAAU,QAAQH,IAAI,CAACI,MAAvB;AACA;;AAED,UAAIC,eAAe,GAAGC,IAAI,CAAC,eAAeN,IAAI,CAACO,IAAL,CAAU,GAAV,CAAf,GAAgC,qDAAjC,CAA1B;AAEAvB,uBAAiB,CAACwB,uCAAlB,CAA0Dd,QAA1D,EAAoEW,eAApE;AACA;AACD,GA/BD;;AAiCA,OAAKI,wBAAL,GAAgC,UAAUlB,cAAV,EAA0B;AACzD,WAAOF,QAAQ,CAACE,cAAD,CAAf;AACA,GAFD;;AAIA,OAAKmB,qBAAL,GAA6B,UAAUnB,cAAV,EAA0B;AACtD,WAAOF,QAAQ,CAACE,cAAD,CAAf;AACA,GAFD;;AAIA,OAAKoB,cAAL,GAAsB,YAAY;AACjC,WAAOtB,QAAP;AACA,GAFD;;AAIA,OAAKuB,QAAL,GAAgB,YAAY;AAC3B,WAAOC,iBAAiB,CAACjC,eAAD,CAAxB;AACA,GAFD;;AAIA,OAAKkC,gBAAL,GAAwB,YAAY;AACnC,WAAOD,iBAAiB,CAACjC,eAAD,CAAjB,CAAmCmC,GAAnC,EAAP;AACA,GAFD,CA9D6C,CAkE7C;;;AAEA,MAAI,QAAOpC,mBAAP,KAA8B,QAAlC,EAA4C;AAC3C,SAAK,IAAIY,cAAT,IAA2BZ,mBAA3B,EAAgD;AAC/C,WAAKW,qBAAL,CAA2BC,cAA3B,EAA2CZ,mBAAmB,CAACY,cAAD,CAA9D;AACA;AACD;AACD;AAAA,C;;;;;;;;;;;;;;;;;;;;;ACjFM,SAASyB,QAAT,CAAkBC,KAAlB,EAAyB;AAC9B,MAAIA,KAAJ,EAAW;AACT,QAAIA,KAAK,CAACC,KAAV,EAAiB;AACf,cAAQC,YAAY,CAACF,KAAK,CAACC,KAAN,EAAD,CAApB;AACE,aAAK,cAAL;AACA,aAAK,sBAAL;AACA,aAAK,uBAAL;AACA,aAAK,cAAL;AACE,iBAAOC,YAAY,CAACF,KAAD,CAAnB;;AACF,aAAK,kBAAL;AACA,aAAK,iBAAL;AACE,iBAAOG,YAAY,CAACH,KAAD,CAAnB;;AACF,aAAK,cAAL;AACA,aAAK,YAAL;AACE,iBAAOI,WAAW,CAACJ,KAAD,CAAlB;;AACF,aAAK,cAAL;AACE,iBAAOK,YAAY,CAACL,KAAD,CAAnB;;AACF;AAAS,iBAAOA,KAAP;AAdX;AAgBD,KAjBD,MAiBO,IAAIM,KAAK,CAACC,OAAN,CAAcP,KAAd,CAAJ,EAA0B;AAC/B,aAAOA,KAAK,CAACQ,GAAN,CAAUT,QAAV,CAAP;AACD,KAFM,MAEA,IAAI,QAAOC,KAAP,MAAiB,QAArB,EAA+B;AACpC,UAAMS,MAAM,GAAG,EAAf;;AACA,WAAK,IAAIC,GAAT,IAAgBV,KAAhB,EAAuB;AACrBS,cAAM,CAACC,GAAD,CAAN,GAAcX,QAAQ,CAACC,KAAK,CAACU,GAAD,CAAN,CAAtB;AACD;;AACD,aAAOD,MAAP;AACD;AACF;;AAED,SAAOT,KAAP;AACD;AAEM,SAASE,YAAT,CAAsBS,GAAtB,EAA2B;AAChC,MAAIA,GAAJ,EAAS;AACP,WAAO,KAAKA,GAAZ;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF;AAEM,SAASN,YAAT,CAAsBO,MAAtB,EAA8B;AACnC,SAAOA,MAAM,GAAG,CAAhB;AACD;AAEM,SAASC,UAAT,CAAoBD,MAApB,EAA4B;AACjC,SAAO,CAAC,EAAEA,MAAM,GAAG,CAAX,CAAR;AACD;AAEM,SAASR,WAAT,CAAqBU,KAArB,EAA4B;AACjC,MAAIC,MAAM,GAAG,EAAb;AACAC,GAAC,CAACC,OAAF,CAAUH,KAAV,EAAiB,UAASI,IAAT,EAAe;AAC9BH,UAAM,CAAC7B,IAAP,CAAYa,QAAQ,CAACmB,IAAD,CAApB;AACD,GAFD;AAGA,SAAOH,MAAP;AACD;AAEM,SAASZ,YAAT,CAAsBgB,IAAtB,EAA4B;AACjC,MAAIJ,MAAM,GAAG,EAAb;AACAC,GAAC,CAACC,OAAF,CAAUE,IAAI,CAACC,OAAL,EAAV,EAA0B,UAASV,GAAT,EAAc;AACtCK,UAAM,CAACL,GAAD,CAAN,GAAcX,QAAQ,CAACoB,IAAI,CAACT,GAAD,CAAL,CAAtB;AACD,GAFD;AAGA,SAAOK,MAAP;AACD,C;;;;;;;;;;;;AC/DD;AAAA;AAAA;AAAA;AAEO,IAAMM,OAAO,GAAI,YAAW;AACjC,MAAIC,cAAJ;;AAEA,WAASC,IAAT,CAAcF,OAAd,EAAuB;AACrBC,kBAAc,GAAGD,OAAjB;AACAG,kDAAM,CAACC,IAAP,CAAY,qBAAZ;AACD;;AAED,WAASC,GAAT,CAAaL,OAAb,EAAsB9C,IAAtB,EAA4B;AAC1B;AACEgD,QAAI,CAACF,OAAD,CAAJ;AAEA9C,QAAI,CAAC8C,OAAD,EAAUA,OAAO,CAACM,QAAlB,CAAJ,CAJwB,CAK1B;AACA;AACA;AACA;;AAEAC,YAAQ;AACT;;AAED,WAASC,OAAT,GAAmB;AACjB,QAAIP,cAAc,IAAI,IAAtB,EAA4B;AAC1B,YAAM,4CAAN;AACD;;AACD,WAAOA,cAAP;AACD;;AAED,WAASQ,cAAT,GAA0B;AACxB,QAAIR,cAAc,IAAI,IAAtB,EAA4B;AAC1B,aAAOA,cAAc,CAACS,OAAf,CAAuBC,IAAvB,EAAP;AACD;;AACD,WAAO,IAAP;AACD;;AAED,WAASC,aAAT,GAAyB;AACvB,QAAIX,cAAc,IAAI,IAAtB,EAA4B;AAC1B,YAAM,4CAAN;AACD;;AACD,QAAIY,UAAU,GAAGZ,cAAc,CAACa,UAAf,CACdC,iCADc,GAEdA,iCAFc,GAGdA,iCAHc,EAAjB;AAIA,WAAOF,UAAP;AACD;;AAED,WAASG,aAAT,CAAuBC,IAAvB,EAA6B;AAC3Bd,kDAAM,CAACe,GAAP,CAAW,kBAAkBD,IAA7B;AACF,QAAIE,GAAG,GAAGC,aAAa,CAACC,iBAAd,EAAV;AACAF,OAAG,CAACG,uBAAJ,CAA4BL,IAA5B,EAAkCR,cAAc,EAAhD;AACA;;AAEA,WAASc,UAAT,GAAsB;AACpB,WAAOtB,cAAP;AACD;;AAED,WAASM,QAAT,GAAoB;AAClBJ,kDAAM,CAACC,IAAP,CAAY,qBAAZ;AACD;;AAED,SAAO;AACLF,QAAI,EAAEA,IADD;AAELG,OAAG,EAAEA,GAFA;AAGLG,WAAO,EAAEA,OAHJ;AAILC,kBAAc,EAAEA,cAJX;AAKLG,iBAAa,EAAEA,aALV;AAMLI,iBAAa,EAAEA,aANV;AAOLO,cAAU,EAAEA,UAPP;AAQLhB,YAAQ,EAAEA;AARL,GAAP;AAUD,CAtEsB,EAAhB,C;;;;;;;;;;;;ACFP;AAAA;AAAA,SAASiB,iBAAT,CAA2BC,OAA3B,EAAoCC,UAApC,EAAgD;AAC5C,MAAIpF,eAAe,GAAG,eAAeC,MAAM,CAACC,IAAP,GAAcC,UAAd,EAArC;AACA,MAAIkF,SAAS,GAAGhF,kBAAkB,CAACC,+CAAnB,CAAmEN,eAAnE,EAAoFoF,UAAU,IAAI7E,QAAlG,CAAhB;AACA8E,WAAS,CAAC7E,aAAV;;AACA,OAAK,IAAIG,cAAT,IAA2BwE,OAA3B,EAAoC;AAChC,QAAIrE,QAAQ,GAAGC,oBAAoB,CAACJ,cAAD,CAAnC;AACA0E,aAAS,CAACC,sCAAV,CAAiDxE,QAAjD,EAA2DqE,OAAO,CAACxE,cAAD,CAAlE;AACH;;AACD,SAAOsB,iBAAiB,CAACjC,eAAD,CAAjB,CAAmCmC,GAAnC,EAAP;AACH;;AAEM,SAASoD,qBAAT,CAA+BC,OAA/B,EAAwCC,WAAxC,EAAqD;AACxD,MAAIC,MAAM,GAAGR,iBAAiB,CAAC;AAC3B,kBAAc,mBAAUS,GAAV,EAAe;AACzB;AACA;AACA;AACA,WAAKC,mBAAL,GAJyB,CAMzB;AACA;;AACAd,mBAAa,CAACC,iBAAd,GAAkCc,SAAlC,CAA4CF,GAA5C;AACH;AAV0B,GAAD,EAW3BG,QAX2B,CAA9B;AAaAJ,QAAM,CAACK,aAAP,CAAqB,oBAArB;AACAL,QAAM,CAACM,cAAP,CAAsB,IAAtB;AACAN,QAAM,CAACO,4CAAP,CAAoD,KAApD;AAEAR,aAAW,CAACS,UAAZ,CAAuBR,MAAvB;AAEA,MAAIS,KAAK,GAAG;AACRT,UAAM,EAAEA,MADA;AAERF,WAAO,EAAEA;AAFD,GAAZ,CApBwD,CAyBxD;;AACAC,aAAW,CAACW,cAAZ,CACIC,kBAAkB,CAACC,iDAAnB,CACI,uBADJ,EAEIC,wCAFJ,EAGI,IAHJ,EAIIJ,KAJJ,CADJ,EA1BwD,CAkCxD;;AACAV,aAAW,CAACW,cAAZ,CACIC,kBAAkB,CAACC,iDAAnB,CACI,uBADJ,EAEIC,wCAFJ,EAGI,IAHJ,EAIIJ,KAJJ,CADJ,EAnCwD,CA2CxD;;AACAV,aAAW,CAACW,cAAZ,CACIC,kBAAkB,CAACG,2EAAnB,CACId,MADJ,EAEIe,oBAFJ,EAGIC,qBAHJ,EAIIlB,OAJJ,EAKIiB,oBALJ,EAMI,CANJ,EAOI,CAPJ,CADJ;AAUH,C;;;;;;;;;;;;ACjED;AAAA;AAAA;AAAA;AAEO,IAAM5C,MAAM,GAAI,YAAW;AAChC,MAAI8C,OAAO,GAAG;AACZC,SAAK,EAAE,CADK;AAEZC,QAAI,EAAE,CAFM;AAGZC,QAAI,EAAE,CAHM;AAIZC,SAAK,EAAE;AAJK,GAAd;AAOA,MAAIC,SAAS,GAAGL,OAAO,CAACE,IAAxB;;AAEA,WAASI,IAAT,CAAcC,KAAd,EAAqBC,OAArB,EAA8BC,IAA9B,EAAoC;AAClC,QAAIF,KAAK,IAAIF,SAAb,EAAwB;AACtB,UAAIK,GAAG,GAAG,IAAIC,IAAJ,EAAV;AACA,UAAIC,MAAM,GAAG,EAAb;;AACA,UAAI7D,gDAAO,IAAIA,gDAAO,CAACS,cAAR,MAA4B,IAA3C,EAAiD;AAC/CoD,cAAM,GAAG7D,gDAAO,CAACS,cAAR,KAA2B,KAApC;AACD;;AACD,UAAIqD,WAAW,GAAG,EAAlB;;AACA,cAAQN,KAAR;AACE,aAAK,CAAL;AACEM,qBAAW,GAAG,OAAd;AACA;;AACF,aAAK,CAAL;AACEA,qBAAW,GAAG,MAAd;AACA;;AACF,aAAK,CAAL;AACEA,qBAAW,GAAG,MAAd;AACA;;AACF,aAAK,CAAL;AACEA,qBAAW,GAAG,OAAd;AACA;;AACF;AACEA,qBAAW,GAAG,SAAd;AAdJ;;AAgBA,UAAIC,UAAU,GAAG,EAAjB;;AACA,UAAIL,IAAI,IAAI,IAAZ,EAAkB;AAChBK,kBAAU,GAAG,QAAQC,IAAI,CAACC,SAAL,CAAeP,IAAf,CAArB;AACD;;AACDxC,SAAG,CAACyC,GAAG,CAACO,WAAJ,KAAoB,GAApB,GAA0BL,MAA1B,GAAmCC,WAAnC,GAAiD,IAAjD,GAAwDL,OAAxD,GAAkEM,UAAnE,CAAH;AACD;AACF;;AAED,WAASI,MAAT,CAAgBV,OAAhB,EAAyBC,IAAzB,EAA+B;AAC7BH,QAAI,CAACN,OAAO,CAACC,KAAT,EAAgBO,OAAhB,EAAyBC,IAAzB,CAAJ;AACD;;AAED,WAASU,KAAT,CAAeX,OAAf,EAAwBC,IAAxB,EAA8B;AAC5BH,QAAI,CAACN,OAAO,CAACE,IAAT,EAAeM,OAAf,EAAwBC,IAAxB,CAAJ;AACD;;AAED,WAASW,KAAT,CAAeZ,OAAf,EAAwBC,IAAxB,EAA8B;AAC5BH,QAAI,CAACN,OAAO,CAACG,IAAT,EAAeK,OAAf,EAAwBC,IAAxB,CAAJ;AACD;;AAED,WAASY,MAAT,CAAgBb,OAAhB,EAAyBC,IAAzB,EAA+B;AAC7BH,QAAI,CAACN,OAAO,CAACI,KAAT,EAAgBI,OAAhB,EAAyBC,IAAzB,CAAJ;AACD;;AAED,WAASa,SAAT,CAAmBf,KAAnB,EAA0B;AACxBF,aAAS,GAAGE,KAAZ;AACD;;AAED,SAAO;AACLtC,OAAG,EAAEkD,KADA;AAELI,SAAK,EAAEL,MAFF;AAGL/D,QAAI,EAAEgE,KAHD;AAILK,QAAI,EAAEJ,KAJD;AAKLK,SAAK,EAAEJ,MALF;AAMLK,UAAM,EAAE1B,OANH;AAOL2B,YAAQ,EAAEL;AAPL,GAAP;AASD,CAvEqB,EAAf,C;;;;;;;;;;;;ACFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEO,IAAMM,QAAQ,GAAI,YAAW;AAClC,MAAMC,GAAG,GAAG,aAAZ;;AAEA,MAAIC,cAAc,GAAG,SAAjBA,cAAiB,GAAW;AAC9B,WAAO/E,gDAAO,CAACQ,OAAR,GAAkBF,QAAlB,CAA2B0E,iBAA3B,EAAP;AACD,GAFD;;AAIA,MAAIC,WAAW,GAAG,SAAdA,WAAc,CAASC,SAAT,EAAoB;AACpC,QAAIC,WAAJ;;AACA,QAAID,SAAJ,EAAe;AACbC,iBAAW,GAAGnF,gDAAO,CAACQ,OAAR,GAAkBE,OAAlB,CAA0B0E,mBAA1B,CAA8CN,GAA9C,EAAmDI,SAAnD,CAAd;AACD,KAFD,MAEO;AACLC,iBAAW,GAAGJ,cAAc,GAAGM,YAAjB,CAA8BP,GAA9B,CAAd;AACD;;AAED,WAAOd,IAAI,CAACsB,KAAL,CAAWH,WAAX,CAAP;AACD,GATD;;AAWA,MAAII,WAAW,GAAG,SAAdA,WAAc,CAASC,UAAT,EAAqBN,SAArB,EAAgCO,OAAhC,EAAyC;AACzD,QAAIN,WAAW,GAAGK,UAAU,IAAI,EAAhC;;AACA,QAAIC,OAAO,IAAIC,SAAX,IAAwBD,OAAO,IAAI,IAAvC,EAA6C;AAC3CN,iBAAW,GAAGQ,oDAAM,CAACV,WAAW,CAACC,SAAD,CAAX,IAA0B,EAA3B,EAA+BM,UAA/B,CAApB;AACD;;AACDL,eAAW,CAACS,SAAZ,GAAwB,IAAIhC,IAAJ,GAAWiC,OAAX,EAAxB;;AAEA,QAAIX,SAAJ,EAAe;AACblF,sDAAO,CAACQ,OAAR,GAAkBE,OAAlB,CAA0BoF,uBAA1B,CAAkD9B,IAAI,CAACC,SAAL,CAAekB,WAAf,CAAlD,EAA+EL,GAA/E,EAAoFI,SAApF;AACD,KAFD,MAEO;AACLH,oBAAc,GAAGgB,gBAAjB,CAAkC/B,IAAI,CAACC,SAAL,CAAekB,WAAf,CAAlC,EAA+DL,GAA/D;AACD;;AAED,QAAIkB,OAAO,GAAGC,8CAAM,CAACC,QAAP,EAAd;AACAlG,oDAAO,CAACQ,OAAR,GAAkBF,QAAlB,CAA2B6F,WAA3B,GAAyCC,SAAzC,CAAmD,CAACJ,OAAD,CAAnD;AACAC,kDAAM,CAACI,WAAP,CAAmBL,OAAnB;AAEA,WAAOb,WAAP;AACD,GAlBD;;AAoBA,MAAImB,cAAc,GAAG,SAAjBA,cAAiB,CAASpB,SAAT,EAAoB;AACvC,QAAIA,SAAJ,EAAe;AACblF,sDAAO,CAACQ,OAAR,GAAkBE,OAAlB,CAA0BoF,uBAA1B,CAAkD,EAAlD,EAAsDhB,GAAtD,EAA2DI,SAA3D;AACD,KAFD,MAEO;AACLH,oBAAc,GAAGgB,gBAAjB,CAAkC,EAAlC,EAAsCjB,GAAtC;AACD;AACF,GAND;;AAQA,SAAO;AACLyB,cAAU,EAAEtB,WADP;AAELuB,cAAU,EAAEjB,WAFP;AAGLkB,iBAAa,EAAEH;AAHV,GAAP;AAKD,CAnDuB,EAAjB;;AAqDP,IAAMI,YAAY,GAAG,SAAfA,YAAe,CAAS1G,OAAT,EAAkB;AACrCA,SAAO,CAACK,GAAR,CAAYL,OAAZ,EAAqB,UAASA,OAAT,EAAkB;AACrCG,kDAAM,CAACyE,QAAP,CAAgBzE,8CAAM,CAACwE,MAAP,CAAczB,KAA9B;AAEA,QAAIyD,cAAc,GAAG3G,OAAO,CAAC4G,SAA7B;AACA,QAAIC,aAAa,GAAGF,cAAc,CAACG,KAAf,EAApB;;AACA,QAAID,aAAa,GAAG,CAApB,EAAuB;AACrB,UAAIE,KAAK,GAAGJ,cAAc,CAAC,CAAD,CAA1B;AACAxG,oDAAM,CAACqE,KAAP,CAAa,OAAb;AACAK,cAAQ,CAAC4B,aAAT,CAAuBM,KAAvB;AACA5G,oDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,CAAoBQ,KAApB,CAAzB;AACA5G,oDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC2B,UAAT,CAAoB;AAACQ,aAAK,EAAE,KAAR;AAAeC,aAAK,EAAE;AAAtB,OAApB,EAA8CF,KAA9C,CAAzB;AACA5G,oDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,CAAoBQ,KAApB,CAAzB;AACA,UAAIG,CAAC,GAAGrC,QAAQ,CAAC0B,UAAT,CAAoBQ,KAApB,CAAR;AACA,aAAOG,CAAC,CAACF,KAAT;AACAE,OAAC,CAACC,KAAF,GAAU,KAAV;AACAhH,oDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC2B,UAAT,CAAoBU,CAApB,EAAuBH,KAAvB,EAA8B,KAA9B,CAAzB;AACA5G,oDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,CAAoBQ,KAApB,CAAzB,EAXqB,CAYrB;AACD;;AAED5G,kDAAM,CAACqE,KAAP,CAAa,QAAb;AACAK,YAAQ,CAAC4B,aAAT;AACAtG,kDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,EAAzB;AACApG,kDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC2B,UAAT,CAAoB;AAACQ,WAAK,EAAE,KAAR;AAAeC,WAAK,EAAE;AAAtB,KAApB,CAAzB;AACA9G,kDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,EAAzB;AACApG,kDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC2B,UAAT,CAAoB;AAACW,WAAK,EAAE,KAAR;AAAeH,WAAK,EAAE;AAAtB,KAApB,CAAzB;AACA7G,kDAAM,CAACqE,KAAP,CAAa,UAAb,EAAyBK,QAAQ,CAAC0B,UAAT,EAAzB,EA1BqC,CA2BrC;AACD,GA5BD;AA6BD,CA9BD,C;;;;;;;;;;;;AC1DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEO,IAAMa,KAAK,GAAI,YAAY;AAChC,MAAMC,cAAc,GAAGC,OAAO,CAACC,6BAAR,CAAsC,KAAK,GAA3C,EAAgD,MAAM,GAAtD,EAA2D,MAAM,GAAjE,EAAsE,CAAtE,CAAvB;AAEAC,UAAQ,CAACC,mBAAT,CAA6B,KAA7B;;AAEA,WAASC,YAAT,CAAsBC,OAAtB,EAA+B;AAC7B,QAAIC,IAAI,GAAG,IAAX;AAAA,QACEC,gBADF;AAAA,QAEEF,OAAO,GAAGhC,oDAAM,CAAC;AACfmC,SAAG,EAAEpC,SADU;AAEfqC,WAAK,EAAE,GAFQ;AAGfC,YAAM,EAAE,GAHO;AAIfC,iBAAW,EAAE,KAJE;AAKfC,iBAAW,EAAE,KALE;AAMfxE,UAAI,EAAE,IANS;AAOfyE,cAAQ,EAAE,kBAAUzE,IAAV,EAAgB;AAAE,eAAOA,IAAP;AAAc;AAP3B,KAAD,EAQbiE,OARa,CAFlB;AAAA,QAWEjI,MAAM,GAAG,KAXX;;AAaA,QAAI,CAACiI,OAAO,CAACS,MAAb,EAAqB;AACnBT,aAAO,CAACG,GAAR,GAAcO,SAAS,CAAC,YAAYV,OAAO,CAACG,GAArB,CAAvB;AACD;;AAED,QAAIQ,KAAK,GAAGC,UAAU,CAAC,CAAD,EAAI,CAAJ,EAAOZ,OAAO,CAACI,KAAf,EAAuBJ,OAAO,CAACK,MAAR,GAAiB,EAAxC,CAAtB;AAAA,QACEQ,cAAc,GAAGlB,OAAO,CAACC,6BAAR,CAAsC,CAAtC,EAAyC,CAAzC,EAA4C,CAA5C,EAA+C,CAA/C,CADnB;;AAGA,QAAII,OAAO,CAACc,UAAZ,EAAwB;AACtBZ,sBAAgB,GAAGa,QAAQ,CAACC,UAAT,GAAsBd,gBAAtB,EAAnB;;AACA,UAAIA,gBAAgB,CAACF,OAAO,CAACc,UAAT,CAApB,EAA0C;AACxCG,gBAAQ,CAACC,eAAT,GAA2BC,oBAA3B,CAAgD,IAAhD;AACA;AACD;AACF;;AAED,QAAMC,KAAK,GAAGC,OAAO,CAACC,KAAR,GAAgB/I,IAAhB,EAAd,CA7B6B,CA+B7B;;AACA6I,SAAK,CAACG,kBAAN,CAAyBC,mBAAzB;AACAJ,SAAK,CAACK,6BAAN,CAAoC,IAApC;AACAL,SAAK,CAACM,oBAAN,CAA2BC,mBAA3B,EAAgDC,SAAhD,CAA0D5B,OAAO,CAACO,WAAlE;AACAa,SAAK,CAACM,oBAAN,CAA2BG,yBAA3B,EAAsDD,SAAtD,CAAgE,IAAhE;AACAR,SAAK,CAACM,oBAAN,CAA2BI,kBAA3B,EAA+CF,SAA/C,CAAyD,IAAzD;AACAR,SAAK,CAACW,gBAAN,CAAuBpB,KAAvB,EAA8B,IAA9B;AACAS,SAAK,CAACY,kBAAN,CAAyBnB,cAAzB;AACAO,SAAK,CAACa,iBAAN,CAAwB,IAAxB;;AAEA,QAAIjC,OAAO,CAACM,WAAZ,EAAyB;AACvBc,WAAK,CAACc,eAAN;AACAd,WAAK,CAACnE,QAAN,CAAekF,qBAAf;AACAjC,sBAAgB,CAACF,OAAO,CAACc,UAAT,CAAhB,GAAuCM,KAAvC,CAHuB,CAIvB;;AACAH,cAAQ,CAACC,eAAT,GAA2BC,oBAA3B,CAAgD,IAAhD;AACD;;AAED,QAAI/G,WAAW,GAAGgH,KAAK,CAAChH,WAAN,EAAlB;AAAA,QACED,OAAO,GAAGiI,OAAO,CAACd,KAAR,GAAgBe,aAAhB,CAA8BzB,UAAU,CAAC,CAAD,EAAI,CAAJ,EAAOZ,OAAO,CAACI,KAAf,EAAsBJ,OAAO,CAACK,MAA9B,CAAxC,CADZ;AAGA,QAAIiC,YAAY,GAAGnI,OAAO,CAACoI,kBAAR,EAAnB;AAEAnI,eAAW,CAACoI,aAAZ,CAA0B,IAA1B;AACApI,eAAW,CAACgF,KAAZ,GAAoBqD,QAApB,CAA6BrI,WAAW,CAACuG,KAAZ,EAA7B,EAvD6B,CAwD7B;AACA;;AAEAxG,WAAO,CAAC6H,kBAAR,CAA2BnB,cAA3B;AACA1G,WAAO,CAACuI,gBAAR,CAAyB1C,OAAO,CAACG,GAAjC;AACA/F,eAAW,CAACS,UAAZ,CAAuBV,OAAvB;AAEA,QAAIwI,QAAQ,GAAG,IAAIC,wDAAJ,CAAoB;AACjC,wCAAmC,sCAAUzI,OAAV,EAAmB0I,QAAnB,EAA6B;AAC9D,YAAIC,QAAQ,GAAG,CACb,iCADa,EAEb,gEAFa,EAGb,8BAHa,EAIb,GAJa,EAKbxM,IALa,CAKR,EALQ,CAAf;AAAA,YAMEyM,QAAQ,GAAG,CACT,IADS,EACH,cADG,EACa,UAAU1G,IAAI,CAACC,SAAL,CAAe0D,OAAO,CAACjE,IAAvB,CAAV,GAAyC,IADtD,EAC4D,GAD5D,EACiE,IADjE,EAETzF,IAFS,CAEJ,EAFI,CANb;;AAUA,YAAI,CAAC0J,OAAO,CAACS,MAAb,EAAqB;AACnB6B,sBAAY,CAACU,iBAAb,CAA+BF,QAA/B;AACAR,sBAAY,CAACU,iBAAb,CAA+BD,QAA/B;AACD;AACF,OAhBgC;AAiBjC,sDAAiD,oDAAU5I,OAAV,EAAmB0I,QAAnB,EAA6B;AAC5E,YAAII,OAAO,GAAGC,KAAK,CAACC,aAAN,CAAoBhJ,OAAO,CAACiJ,YAAR,EAApB,EAA4CC,QAA5C,EAAd;;AAEA,YAAIJ,OAAO,IAAI,QAAf,EAAyB;AACvB,cAAIlH,IAAI,GAAGM,IAAI,CAACsB,KAAL,CAAW2F,SAAS,CAAChB,YAAY,CAACiB,WAAb,CAAyB,QAAzB,CAAD,CAApB,CAAX;;AACA,cAAI;AACFvD,mBAAO,CAACQ,QAAR,CAAiBzE,IAAjB;AACD,WAFD,CAEE,OAAOyH,CAAP,EAAU;AACVhL,0DAAM,CAACuE,KAAP,CAAayG,CAAb;AACD;;AACDzL,gBAAM,GAAG,IAAT;;AACA,cAAI,CAACiI,OAAO,CAACM,WAAb,EAA0B;AACxBgC,wBAAY,CAACU,iBAAb,CAA+B,iCAA/B;AACD;AACF;;AAED,YAAIC,OAAO,IAAI,UAAf,EAA2B;AACzB,cAAIlH,IAAI,GAAGM,IAAI,CAACsB,KAAL,CAAW2F,SAAS,CAAChB,YAAY,CAACiB,WAAb,CAAyB,aAAzB,CAAD,CAApB,CAAX;AACAE,YAAE,CAACC,QAAH,GAAcC,kBAAd,CAAiC5H,IAAjC;AACAhE,gBAAM,GAAG,IAAT;AACD;;AAED,YAAIkL,OAAO,IAAI,YAAf,EAA6B;AAC3B,cAAIlH,IAAI,GAAGM,IAAI,CAACsB,KAAL,CAAW2F,SAAS,CAAChB,YAAY,CAACiB,WAAb,CAAyB,aAAzB,CAAD,CAApB,CAAX;AACAE,YAAE,CAACG,OAAH,CAAW7H,IAAX;AACD;;AAED,YAAIkH,OAAO,IAAI,aAAf,EAA8B;AAC5B,cAAIlH,IAAI,GAAGM,IAAI,CAACsB,KAAL,CAAW2F,SAAS,CAAChB,YAAY,CAACiB,WAAb,CAAyB,eAAzB,CAAD,CAApB,CAAX;AACAE,YAAE,CAACI,UAAH,GAAgBC,qBAAhB,CAAsC/H,IAAtC;AACD;;AAED,YAAIkH,OAAO,IAAI,iBAAf,EAAkC;AAChC/I,6FAAqB,CAACC,OAAD,EAAUC,WAAV,CAArB;AACD;;AAED,YAAI6I,OAAO,IAAI,OAAf,EAAwB;AACtB,cAAI,CAACjD,OAAO,CAACM,WAAb,EAA0B;AACxBc,iBAAK,CAAC2C,QAAN,CAAeC,GAAf;AACAC,iBAAK,CAACC,SAAN;AACD,WAHD,MAIK;AACH9C,iBAAK,CAAC+C,KAAN;AACD;AACF;;AAED,YAAIlB,OAAO,IAAI,OAAf,EAAwB;AACtB,cAAImB,KAAK,GAAGhD,KAAK,CAACiD,YAAN,GAAqBC,gBAArB,EAAZ;AAAA,cACEC,CAAC,GAAGC,QAAQ,CAACpD,KAAK,CAACT,KAAN,EAAD,CAAR,GAA0ByD,KAAK,CAACG,CAAhC,GAAoC,EAD1C;AAEAjC,sBAAY,CAACU,iBAAb,CAA+B,qBAAqBoB,KAAK,CAACK,CAA3B,GAA+B,IAA/B,GAAsCF,CAAtC,GAA0C,GAAzE;AACD;;AACDjC,oBAAY,CAACU,iBAAb,CAA+B,4BAA/B;AACD;AArEgC,KAApB,CAAf;AAwEA7I,WAAO,CAACuK,qBAAR,CAA8B/B,QAAQ,CAAC9L,gBAAT,EAA9B,EAvI6B,CAwI7B;AACA;;AACA,QAAImJ,OAAO,CAACM,WAAZ,EAAyB;AACvBc,WAAK,CAACuD,MAAN;AACAvD,WAAK,CAACwD,oBAAN,CAA2BZ,GAA3B;AACD;;AAED,QAAIa,WAAW,GAAGzD,KAAK,CAACM,oBAAN,CAA2BC,mBAA3B,CAAlB;AACAkD,eAAW,CAACC,sBAAZ,CAAmC,UAAUC,MAAV,EAAkB;AACnD,UAAI9B,OAAO,GAAGC,KAAK,CAACC,aAAN,CAAoBhJ,OAAO,CAACiJ,YAAR,EAApB,EAA4CC,QAA5C,EAAd;;AAEA,UAAIrD,OAAO,CAACM,WAAR,IAAuB2C,OAAO,IAAI,QAAtC,EAAgD;AAC9ClH,YAAI,GAAGM,IAAI,CAACsB,KAAL,CAAW2F,SAAS,CAAChB,YAAY,CAACiB,WAAb,CAAyB,QAAzB,CAAD,CAApB,CAAP;AACAvD,eAAO,CAACQ,QAAR,CAAiBzE,IAAjB;AACD;;AAED,UAAIiE,OAAO,CAACc,UAAZ,EAAwB;AACtBZ,wBAAgB,CAAC8E,kBAAjB,CAAoChF,OAAO,CAACc,UAA5C;AACD;;AAEDb,UAAI,CAACgF,SAAL,GAAiB,IAAjB;;AACA,UAAIjF,OAAO,CAACM,WAAZ,EAAyB;AACvBc,aAAK,CAAC+C,KAAN;AACD,OAFD,MAGK;AACH/C,aAAK,CAAC2C,QAAN,CAAeC,GAAf;AACAC,aAAK,CAACC,SAAN;AACD;AAEF,KArBD;AAsBAW,eAAW,CAACK,SAAZ,CAAsB,aAAtB;AAEA,QAAIC,YAAY,GAAG/K,WAAW,CAACgL,SAAZ,GAAwBC,sBAAxB,GAAiDC,IAAjD,EAAnB;AAAA,QACEC,qBAAqB,GAAGJ,YAAY,CAACC,SAAb,EAD1B;AAEAP,eAAW,CAACW,cAAZ,CAA2BC,WAAW,CAAC,CAAD,EAAI,CAAJ,CAAtC;AACAF,yBAAqB,CAAC9C,QAAtB,CAA+B7B,UAAU,CAAC,CAAD,EAAIZ,OAAO,CAACK,MAAZ,EAAoBL,OAAO,CAACI,KAA5B,EAAmC,EAAnC,CAAzC;AACA+E,gBAAY,CAACO,YAAb,CAA0BC,UAAU,CAAC3F,OAAO,CAACI,KAAT,EAAgB,EAAhB,CAApC;AACA+E,gBAAY,CAACxK,cAAb,CAA4B,IAA5B;AACAwK,gBAAY,CAACnD,kBAAb,CAAgCtC,cAAhC;AACA6F,yBAAqB,CAACH,SAAtB,GAAkCpD,kBAAlC,CAAqDtC,cAArD;;AAEA,QAAI,CAACM,OAAO,CAACM,WAAb,EAA0B;AACxB2D,WAAK,CAAC2B,iBAAN,CAAwBxE,KAAxB;AACD;;AAED,WAAOrJ,MAAP;AACD;;AAED,SAAO;AACL8N,eAAW,EAAE9F;AADR,GAAP;AAGD,CAhMoB,EAAd,C;;;;;;;;;;;;ACLP;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEO,IAAM+F,MAAM,GAAI,YAAW;AAChC,WAASC,oDAAT,CAA8DC,SAA9D,EAAyEzI,SAAzE,EAAoF0I,SAApF,EAA+F;AAC7F,QAAIC,GAAG,GAAG7N,gDAAO,CAACQ,OAAR,GAAkBF,QAA5B;AACA,QAAIwN,KAAJ;;AACA,YAAQF,SAAR;AACE,WAAKG,MAAL;AACED,aAAK,GAAGD,GAAG,CAACG,KAAJ,EAAR;AACA,eAAOF,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAAP;AACF;;AAEA,WAAKO,eAAL;AACE,YAAI,OAAOhJ,SAAP,KAAqB,WAArB,IAAoCA,SAAS,IAAIyG,GAArD,EAA0D;AACxD,cAAIzG,SAAS,CAACiJ,SAAV,IAAuB,QAA3B,EAAqC;AACnCL,iBAAK,GAAG5I,SAAS,CAACkJ,SAAV,EAAR;AACA,mBAAON,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAAP;AACD;AACF,SALD,MAKO;AACL;AACA,cAAIU,aAAa,GAAGC,OAAO,CAAC7O,KAAR,EAApB;AACA,cAAI8O,SAAS,GAAGV,GAAG,CAACG,KAAJ,GAAYQ,gBAAZ,EAAhB;AAAA,cAAgDC,IAAhD;;AACA,iBAAOA,IAAI,GAAGF,SAAS,CAACG,UAAV,EAAd,EAAsC;AACpCZ,iBAAK,GAAGW,IAAI,CAACL,SAAL,EAAR;AACAC,yBAAa,GAAGA,aAAa,CAACM,6BAAd,CAA4Cb,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAA5C,CAAhB;AACD;;AACD,iBAAOU,aAAP;AACD;;AACH;;AAEA,WAAKO,cAAL;AACEd,aAAK,GAAGD,GAAG,CAACgB,YAAJ,GAAmBC,UAAnB,EAAR;AACA,eAAOhB,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAAP;AACA;;AAEF;AACE,YAAI,OAAOzI,SAAP,KAAqB,WAArB,IAAoCA,SAAS,IAAIyG,GAArD,EAA0D;AACxDmC,eAAK,GAAG5I,SAAS,CAAC6J,QAAV,EAAR;AACA,iBAAOjB,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAAP;AACD,SAHD,MAGO;AACL;AACA,cAAIU,aAAa,GAAGC,OAAO,CAAC7O,KAAR,EAApB;AACA,cAAI8O,SAAS,GAAGV,GAAG,CAACG,KAAJ,GAAYQ,gBAAZ,EAAhB;AAAA,cAAgDC,IAAhD;;AACA,iBAAOA,IAAI,GAAGF,SAAS,CAACG,UAAV,EAAd,EAAsC;AACpCZ,iBAAK,GAAGW,IAAI,CAACM,QAAL,EAAR;AACAV,yBAAa,GAAGA,aAAa,CAACM,6BAAd,CAA4Cb,KAAK,CAACG,2BAAN,CAAkCN,SAAlC,CAA5C,CAAhB;AACD;;AACD,iBAAOU,aAAP;AACD;;AA1CL;;AA4CA,WAAOC,OAAO,CAAC7O,KAAR,EAAP,CA/C6F,CA+CrE;AACzB;AAED;;;;;;;;;;AAUA,WAASuP,eAAT,CAAyBC,QAAzB,EAAmC;AACjC,QAAItB,SAAS,GAAGuB,WAAW,CAACC,mBAAZ,CAAgC,YAAhC,EAA8CF,QAA9C,CAAhB;AACA,WAAOvB,oDAAoD,CAACC,SAAD,EAAYhC,GAAZ,EAAiBoC,MAAjB,CAA3D;AACD;;AAED,WAASqB,eAAT,CAAyBC,EAAzB,EAA6B;AAC3B,QAAI1B,SAAS,GAAGuB,WAAW,CAACC,mBAAZ,CAAgC,gBAAhC,EAAkDE,EAAlD,CAAhB;AACA,WAAO3B,oDAAoD,CAACC,SAAD,EAAYhC,GAAZ,EAAiBiD,cAAjB,CAA3D;AACD;;AAED,WAASU,iBAAT,CAA2B3O,IAA3B,EAAiC;AAC/B,QAAIgN,SAAS,GAAGuB,WAAW,CAACC,mBAAZ,CAAgC,YAAhC,EAA8CxO,IAA9C,CAAhB;AACA,WAAO+M,oDAAoD,CAACC,SAAD,EAAYhC,GAAZ,EAAiBiD,cAAjB,CAA3D;AACD;;AAED,WAASW,sBAAT,CAAgC5O,IAAhC,EAAsC;AACpC,QAAIgN,SAAS,GAAGuB,WAAW,CAACC,mBAAZ,CAAgC,wBAAhC,EAA0DxO,IAA1D,CAAhB;AACA,WAAO+M,oDAAoD,CAACC,SAAD,EAAYhC,GAAZ,EAAiBiD,cAAjB,CAA3D;AACD;;AAED,WAASY,oBAAT,CAA8BC,SAA9B,EAAyC;AACvC,QAAI5B,GAAG,GAAG7N,gDAAO,CAACQ,OAAR,GAAkBF,QAA5B;AACF,QAAIoP,MAAM,GAAG7B,GAAG,CAACgB,YAAJ,GAAmBc,WAAnB,GAAiCC,OAAjC,EAAb;;AAEA,QAAIF,MAAJ,EAAY;AACX,WAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,MAAM,CAAC5I,KAAP,EAApB,EAAoC+I,CAAC,EAArC,EAAyC;AACxC,YAAIH,MAAM,CAACI,aAAP,CAAqBD,CAArB,EAAwBlP,IAAxB,MAAkC8O,SAAtC,EAAiD;AAC/C,iBAAOC,MAAM,CAACI,aAAP,CAAqBD,CAArB,CAAP;AACD;AACD;AACD;;AAED,WAAO,KAAP;AACA;;AAEA,WAASE,mBAAT,CAA6BN,SAA7B,EAAwC;AACtC,QAAI5B,GAAG,GAAG7N,gDAAO,CAACQ,OAAR,GAAkBF,QAA5B;AACF,QAAI0P,UAAU,GAAGnC,GAAG,CAACgB,YAAJ,GAAmBoB,eAAnB,GAAqCL,OAArC,EAAjB;;AAEA,QAAII,UAAJ,EAAgB;AACf,WAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,UAAU,CAAClJ,KAAX,EAApB,EAAwC+I,CAAC,EAAzC,EAA6C;AAC5C,YAAIG,UAAU,CAACF,aAAX,CAAyBD,CAAzB,EAA4BlP,IAA5B,MAAsC8O,SAA1C,EAAqD;AACnD,iBAAOO,UAAU,CAACF,aAAX,CAAyBD,CAAzB,CAAP;AACD;AACD;AACD;;AAED,WAAO,KAAP;AACA;;AAEA,WAASK,iBAAT,CAA2BC,OAA3B,EAAoC;AAClCA,WAAO,GAAGtR,4DAAY,CAACsR,OAAD,CAAtB,CADkC,CAElC;;AACA,QAAItC,GAAG,GAAG7N,gDAAO,CAACQ,OAAR,GAAkBF,QAA5B;AACF,QAAI0P,UAAU,GAAGnC,GAAG,CAACgB,YAAJ,GAAmBoB,eAAnB,GAAqCL,OAArC,EAAjB;;AAEA,QAAII,UAAJ,EAAgB;AACf,WAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,UAAU,CAAClJ,KAAX,EAApB,EAAwC+I,CAAC,EAAzC,EAA6C;AACxC,YAAIrP,OAAO,GAAGwP,UAAU,CAACF,aAAX,CAAyBD,CAAzB,CAAd,CADwC,CAExC;;AACJ,YAAIhR,4DAAY,CAAC2B,OAAO,CAAC4P,QAAR,EAAD,CAAZ,KAAqCD,OAAzC,EAAkD;AAChD,iBAAO3P,OAAP;AACD;AACD;AACD;;AAECL,kDAAM,CAACsE,IAAP,CAAY,gCAAgC0L,OAAhC,GAA0C,uBAAtD;AACF,WAAO,KAAP;AACA;;AAEA,SAAO;AACLzC,wDAAoD,EAAEA,oDADjD;AAELsB,mBAAe,EAAEA,eAFZ;AAGLI,mBAAe,EAAEA,eAHZ;AAILE,qBAAiB,EAAEA,iBAJd;AAKLC,0BAAsB,EAAEA,sBALnB;AAMLC,wBAAoB,EAAEA,oBANjB;AAOLO,uBAAmB,EAAEA,mBAPhB;AAQLG,qBAAiB,EAAEA;AARd,GAAP;AAUD,CA7IqB,EAAf,C;;;;;;;;;;;;ACJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEO,IAAMjK,MAAM,GAAG,EAAf;AAEPN,oDAAM,CAACM,MAAD,EAAS;AACboK,IAAE,EAAE,YAAStJ,KAAT,EAAgBuJ,QAAhB,EAA0B;AAC5B,QAAI,CAACvJ,KAAL,EAAY,OAAO,KAAP;AACZ,QAAIwJ,KAAK,GAAGxJ,KAAK,CAACnI,KAAN,EAAZ;AACA,WAAO2R,KAAK,KAAKD,QAAjB;AACD,GALY;AAMbE,UAAQ,EAAE,oBAAW;AACnB,WAAOC,YAAY,CAAChS,GAAb,EAAP;AACD,GARY;AASbyH,UAAQ,EAAE,oBAAW;AACnB,WAAOwK,YAAY,CAACC,aAAb,CAA2BpI,UAAU,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,GAAZ,CAArC,CAAP;AACD,GAXY;AAYbqI,SAAO,EAAE,iBAASC,MAAT,EAAiB;AACxB,QAAIC,IAAI,GAAGC,WAAW,CAACtS,GAAZ,EAAX;AACAqS,QAAI,CAACE,cAAL,CAAoBH,MAAM,IAAI,MAA9B;AACA,WAAOC,IAAP;AACD,GAhBY;AAiBbzK,aAAW,EAAE,qBAASU,KAAT,EAAgB;AAC3B,QAAI7B,SAAS,GAAG6B,KAAK,CAACkK,WAAN,EAAhB;AACA,QAAI/L,SAAJ,EAAeA,SAAS,CAACmB,WAAV,CAAsBU,KAAtB;AAChB,GApBY;AAqBbmK,gBAAc,EAAE,wBAASC,MAAT,EAAiBC,KAAjB,EAAwBC,KAAxB,EAA+B;AAC7C,QAAI,CAAC,KAAKhB,EAAL,CAAQe,KAAR,EAAelD,eAAf,CAAL,EAAsC;AACpCmD,WAAK,CAACC,uBAAN,CAA8BH,MAA9B,EAAsCC,KAAtC;AACAA,WAAK,CAACE,uBAAN,CAA8BH,MAA9B,EAAsCE,KAAtC;AACD;AACF,GA1BY;AA2BbE,WAAS,EAAE,mBAASxK,KAAT,EAAgB;AACzBA,SAAK,CAACyK,eAAN,GAAwB,IAAxB;AACAzK,SAAK,CAAC0K,gBAAN,GAAyB,CAAzB,CAFyB,CAEG;AAC7B,GA9BY;AA+BbC,WAAS,EAAE,mBAAS3K,KAAT,EAAgB4K,MAAhB,EAAwB;AACjCA,UAAM,GAAG,KAAKA,MAAd;AACA5K,SAAK,CAAC6K,MAAN,GAAeC,WAAf,GAA6BC,6BAA7B,CAA2DH,MAA3D;AACD,GAlCY;AAmCbI,cAAY,EAAE,sBAASC,KAAT,EAAgB;AAC5B,QAAIC,IAAI,GAAGD,KAAK,CAACE,oBAAN,EAAX;AACA,WAAO;AACL9F,OAAC,EAAE+F,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,EAAX,CADE;AAELF,OAAC,EAAEiG,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,EAAX,CAFE;AAGLnE,WAAK,EAAEoK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAClK,KAAL,EAAX,CAHF;AAILC,YAAM,EAAEmK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAACjK,MAAL,EAAX,CAJH;AAKLqK,UAAI,EAAEF,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,KAAW6F,IAAI,CAAClK,KAAL,EAAtB,CALD;AAMLuK,UAAI,EAAEH,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,KAAW+F,IAAI,CAACjK,MAAL,EAAtB,CAND;AAOLuK,UAAI,EAAE,cAASnG,CAAT,EAAY;AAAE6F,YAAI,CAACM,IAAL,CAAUnG,CAAV;AAAc,aAAKA,CAAL,GAASA,CAAT;AAAY,aAAKiG,IAAL,GAAY,KAAKjG,CAAL,GAAS,KAAKrE,KAA1B;AAAkC,OAP3E;AAQLyK,UAAI,EAAE,cAAStG,CAAT,EAAY;AAAE+F,YAAI,CAACO,IAAL,CAAUtG,CAAV;AAAc,aAAKA,CAAL,GAASA,CAAT;AAAY,aAAKoG,IAAL,GAAY,KAAKpG,CAAL,GAAS,KAAKlE,MAA1B;AAAmC,OAR5E;AASLyK,cAAQ,EAAE,kBAAS1K,KAAT,EAAgB;AAAEkK,YAAI,CAACQ,QAAL,CAAc1K,KAAd;AAAsB,aAAKA,KAAL,GAAaA,KAAb;AAAoB,aAAKsK,IAAL,GAAY,KAAKjG,CAAL,GAAS,KAAKrE,KAA1B;AAAkC,OATnG;AAUL2K,eAAS,EAAE,mBAAS1K,MAAT,EAAiB;AAAEiK,YAAI,CAACS,SAAL,CAAe1K,MAAf;AAAwB,aAAKA,MAAL,GAAcA,MAAd;AAAsB,aAAKsK,IAAL,GAAY,KAAKpG,CAAL,GAAS,KAAKlE,MAA1B;AAAmC;AAV1G,KAAP;AAYD,GAjDY;AAkDb2K,SAAO,EAAE,iBAAS5L,KAAT,EAAgB;AACvB,QAAIkL,IAAI,GAAGlL,KAAK,CAACuB,KAAN,EAAX;AACA,WAAO;AACL8D,OAAC,EAAE+F,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,EAAX,CADE;AAELF,OAAC,EAAEiG,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,EAAX,CAFE;AAGLnE,WAAK,EAAEoK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAClK,KAAL,EAAX,CAHF;AAILC,YAAM,EAAEmK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAACjK,MAAL,EAAX,CAJH;AAKLqK,UAAI,EAAEF,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,KAAW6F,IAAI,CAAClK,KAAL,EAAtB,CALD;AAMLuK,UAAI,EAAEH,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,KAAW+F,IAAI,CAACjK,MAAL,EAAtB,CAND;AAOLuK,UAAI,EAAE,cAASnG,CAAT,EAAY;AAAE6F,YAAI,CAACM,IAAL,CAAUnG,CAAV;AAAc,aAAKA,CAAL,GAASA,CAAT;AAAY,aAAKiG,IAAL,GAAY,KAAKjG,CAAL,GAAS,KAAKrE,KAA1B;AAAkC,OAP3E;AAQLyK,UAAI,EAAE,cAAStG,CAAT,EAAY;AAAE+F,YAAI,CAACO,IAAL,CAAUtG,CAAV;AAAc,aAAKA,CAAL,GAASA,CAAT;AAAY,aAAKoG,IAAL,GAAY,KAAKpG,CAAL,GAAS,KAAKlE,MAA1B;AAAmC,OAR5E;AASLyK,cAAQ,EAAE,kBAAS1K,KAAT,EAAgB;AAAEkK,YAAI,CAACQ,QAAL,CAAc1K,KAAd;AAAsB,aAAKA,KAAL,GAAaA,KAAb;AAAoB,aAAKsK,IAAL,GAAY,KAAKjG,CAAL,GAAS,KAAKrE,KAA1B;AAAkC,OATnG;AAUL2K,eAAS,EAAE,mBAAS1K,MAAT,EAAiB;AAAEiK,YAAI,CAACS,SAAL,CAAe1K,MAAf;AAAwB,aAAKA,MAAL,GAAcA,MAAd;AAAsB,aAAKsK,IAAL,GAAY,KAAKpG,CAAL,GAAS,KAAKlE,MAA1B;AAAmC,OAV1G;AAWL4K,6BAAuB,EAAE,iCAASC,GAAT,EAAc;AAAEZ,YAAI,CAACW,uBAAL,CAA6BC,GAA7B;AAAoC;AAXxE,KAAP;AAaD,GAjEY;AAkEbC,sBAAoB,EAAE,aAlET;AAmEbC,iBAAe,EAAE,yBAASC,QAAT,EAAmBC,MAAnB,EAA2B;AAC1C,QAAIC,iBAAiB,GAAGF,QAAQ,CAACG,SAAT,EAAxB;;AACA,QAAI,CAACD,iBAAL,EAAwB;AAAEA,uBAAiB,GAAGE,mBAAmB,CAACC,UAApB,EAApB;AAAuD;;AACjF,QAAIC,gBAAgB,GAAGF,mBAAmB,CAACG,wBAApB,CAA6CL,iBAA7C,CAAvB;;AAEA,QAAIM,YAAY,GAAG,KAAKC,eAAL,CAAqBT,QAArB,EAA+BC,MAA/B,CAAnB;;AAEA,SAAK,IAAI5D,EAAT,IAAemE,YAAf,EAA6B;AAC3BF,sBAAgB,CAACvN,gBAAjB,CAAkCyN,YAAY,CAACnE,EAAD,CAA9C,EAAoDA,EAApD;AACD;;AAED2D,YAAQ,CAACG,SAAT,GAAqBG,gBAArB;AACD,GA/EY;AAgFbG,iBAAe,EAAE,yBAASC,gBAAT,EAA2BT,MAA3B,EAAmC;AAClD,QAAIO,YAAY,GAAG,EAAnB;AACA,QAAIG,YAAY,GAAID,gBAAgB,CAACvF,SAAjB,MAAgC,kBAAhC,GAAqDuF,gBAAgB,CAACC,YAAjB,EAArD,GAAuFD,gBAA3G;;AACA,QAAIC,YAAY,IAAI,IAApB,EAA0B;AACxBxT,oDAAM,CAACuE,KAAP,CAAa,gFAAb;AACD;;AACD,QAAIqK,QAAQ,GAAG4E,YAAY,CAAC5E,QAAb,EAAf;;AACA,SAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,QAAQ,CAACjI,KAAT,EAApB,EAAsC+I,CAAC,EAAvC,EAA2C;AACzC,UAAI9I,KAAK,GAAGgI,QAAQ,CAACc,CAAD,CAApB;;AACA,UAAI9I,KAAK,CAAC6M,SAAN,MAAqB,CAArB,IAA0B7M,KAAK,CAAC8M,QAAN,MAAoB,CAAlD,EAAqD;AACnD,YAAIC,UAAU,GAAGC,MAAM,CAACC,IAAP,CAAYf,MAAZ,CAAjB;;AACA,YAAIlM,KAAK,CAACoH,SAAN,MAAqB,kBAAzB,EAA6C;AAC3C;AACA,cAAI8F,WAAW,GAAGhB,MAAM,CAAClM,KAAK,CAACpG,IAAN,EAAD,CAAxB;AACA,cAAIuT,qBAAqB,GAAGnN,KAA5B;AAEA,cAAIoN,cAAc,GAAG,EAArB;;AAEA,cAAIF,WAAW,IAAI,IAAnB,EAAyB;AACvB,gBAAIG,MAAM,GAAGH,WAAW,CAAC,UAAD,CAAxB,CADuB,CAEvB;;AACA,gBAAIG,MAAM,IAAInO,MAAM,CAAC6M,oBAArB,EAA2C;AACzCqB,4BAAc,CAAC,UAAD,CAAd,GAA6B,EAA7B;AACD,aAFD,MAEO,IAAIC,MAAM,IAAI,IAAd,EAAoB;AACzBD,4BAAc,CAAC,UAAD,CAAd,GAA6BC,MAAM,CAACC,QAAP,EAA7B;AACAH,mCAAqB,GAAGE,MAAxB;AACD;AACF;;AAED,cAAIE,cAAc,GAAG,KAAKb,eAAL,CAAqBS,qBAArB,EAA4CD,WAAW,IAAIhB,MAA3D,CAArB;;AACAkB,wBAAc,GAAGxO,oDAAM,CAACwO,cAAD,EAAiBG,cAAjB,CAAvB;AAEA;;;;;;;;;AASA,cAAIC,aAAa,GAAGR,MAAM,CAACC,IAAP,CAAYG,cAAZ,EAA4BrW,MAAhD;;AACA,cAAIyW,aAAa,GAAG,CAApB,EAAuB;AACrB;AACAf,wBAAY,CAACzM,KAAK,CAACqJ,QAAN,EAAD,CAAZ,GAAiC+D,cAAjC;AACD;AACF,SAnCD,MAmCO;AACL;AACA,eAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,UAAU,CAAChW,MAA/B,EAAuC0W,CAAC,EAAxC,EAA4C;AAC1C,gBAAIC,SAAS,GAAGX,UAAU,CAACU,CAAD,CAA1B;;AACA,gBAAIzN,KAAK,CAACpG,IAAN,MAAgBmT,UAAU,CAACU,CAAD,CAA9B,EAAmC;AACjC;AACAhB,0BAAY,CAACzM,KAAK,CAACqJ,QAAN,EAAD,CAAZ,GAAiC6C,MAAM,CAACwB,SAAD,CAAvC;AACA;AACD;AACF;AACF;AACF;AACF;;AAED,WAAOjB,YAAP;AACD,GA7IY;AA8IbkB,mBAAiB,EAAE,2BAAS1B,QAAT,EAAmB;AACpC,QAAIE,iBAAiB,GAAGF,QAAQ,CAACG,SAAT,EAAxB;AACA,WAAO,KAAKwB,uBAAL,CAA6B,EAA7B,EAAiC3B,QAAjC,EAA2CE,iBAA3C,CAAP;AACD,GAjJY;AAkJbyB,yBAAuB,EAAE,iCAASC,MAAT,EAAiB5B,QAAjB,EAA2BG,SAA3B,EAAsC;AAC7D,QAAI0B,GAAG,GAAG,IAAV;;AACA,QAAI1B,SAAS,IAAI,IAAjB,EAAuB;AACrB0B,SAAG,GAAG,EAAN;AACA,UAAIlB,YAAY,GAAGX,QAAQ,CAACW,YAAT,EAAnB;AACA,UAAImB,QAAQ,GAAG3B,SAAS,CAAC,UAAD,CAAxB;;AACA,UAAI2B,QAAQ,IAAIpP,SAAhB,EAA2B;AACzB,YAAIoP,QAAQ,IAAI,EAAhB,EAAoB;AAClB3U,wDAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,gBAAtB;AACAC,aAAG,CAAC,QAAD,CAAH,GAAgB,IAAhB;AACD,SAHD,MAGO;AACLlB,sBAAY,GAAGlG,8CAAM,CAAC2B,eAAP,CAAuB0F,QAAvB,EAAiC,CAAjC,CAAf;AACA3U,wDAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,mBAAT,GAA+BjB,YAAY,CAAChT,IAAb,EAA5C;AACAkU,aAAG,CAAC,QAAD,CAAH,GAAgBhW,4DAAY,CAAC8U,YAAY,CAAChT,IAAb,EAAD,CAA5B;AACD;AACF;;AACDR,oDAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,kBAAT,GAA8BzB,SAAS,CAACrM,KAAV,EAA3C;AACA,UAAIkN,IAAI,GAAGb,SAAS,CAACpT,OAAV,EAAX,CAfqB,CAgBrB;;AACA,WAAK,IAAI8P,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmE,IAAI,CAAClW,MAAzB,EAAiC+R,CAAC,EAAlC,EAAsC;AACpC,YAAIxQ,GAAG,GAAG2U,IAAI,CAACnE,CAAD,CAAd;AACA,YAAI9I,KAAK,GAAG,IAAZ;AACA,YAAIgI,QAAQ,GAAG4E,YAAY,CAAC5E,QAAb,EAAf;;AACA,aAAK,IAAIyF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzF,QAAQ,CAACjI,KAAT,EAApB,EAAsC0N,CAAC,EAAvC,EAA2C;AACzC,cAAIO,KAAK,GAAGhG,QAAQ,CAACyF,CAAD,CAApB;AACArU,wDAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,aAAT,GAAyBG,KAAK,CAAC3E,QAAN,EAAzB,GAA4C,IAA5C,GAAmD2E,KAAK,CAACpU,IAAN,EAAnD,GAAkE,GAA/E;;AACA,cAAI9B,4DAAY,CAACkW,KAAK,CAAC3E,QAAN,EAAD,CAAZ,IAAkCvR,4DAAY,CAACQ,GAAD,CAAlD,EAAyD;AACvDc,0DAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,iBAAT,GAA6BG,KAAK,CAACpU,IAAN,EAA1C;AACAoG,iBAAK,GAAGgO,KAAR;AACA;AACD;AACF;;AACD,YAAIhO,KAAK,IAAI,IAAb,EAAmB;AACjB,cAAIoN,cAAc,GAAGhB,SAAS,CAAC9N,YAAV,CAAuBhG,GAAvB,CAArB;AACAc,wDAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,UAAT,GAAsB7N,KAAK,CAACoH,SAAN,EAAtB,GAA0C,aAA1C,GAA0DgG,cAAvE;;AACA,cAAI,KAAK9D,EAAL,CAAQtJ,KAAR,EAAeiO,gBAAf,CAAJ,EAAsC;AACpC,gBAAIC,SAAS,GAAG,KAAKN,uBAAL,CAA6BC,MAAM,GAAG,IAAtC,EAA4C7N,KAA5C,EAAmDoN,cAAnD,CAAhB;;AACA,gBAAIc,SAAS,IAAI,IAAjB,EAAuB;AACrB9U,4DAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,gBAAtB;AACAC,iBAAG,CAAC9N,KAAK,CAACpG,IAAN,EAAD,CAAH,GAAoBsU,SAApB;AACD;AACF,WAND,MAMO;AACL9U,0DAAM,CAACqE,KAAP,CAAaoQ,MAAM,GAAG,aAAT,GAAyBT,cAAc,CAAChG,SAAf,EAAtC;AACA0G,eAAG,CAAC9N,KAAK,CAACpG,IAAN,EAAD,CAAH,GAAoB9B,4DAAY,CAACsV,cAAD,CAAhC;AACD;AACF;AACF;AACF;;AACD,WAAOU,GAAP;AACD,GAnMY;AAoMbK,WAAS,EAAE,mBAAS5V,GAAT,EAAc;AACvB,WAAO,KAAK6V,UAAL,CAAgB7V,GAAhB,EAAqBmG,OAArB,CAA6B,WAA7B,EAA0C,GAA1C,CAAP;AACD,GAtMY;AAuMb2P,cAAY,EAAE,sBAAS9V,GAAT,EAAc;AAC1B,WAAO,KAAK6V,UAAL,CAAgB7V,GAAhB,EACJmG,OADI,CACI,KADJ,EACW,MADX,EAEJA,OAFI,CAEI,KAFJ,EAEW,MAFX,EAGJA,OAHI,CAGI,KAHJ,EAGW,OAHX,EAIJA,OAJI,CAII,KAJJ,EAIW,QAJX,EAKJA,OALI,CAKI,SALJ,EAKe,SALf,EAMJA,OANI,CAMI,SANJ,EAMe,SANf,EAOJA,OAPI,CAOI,gBAPJ,EAOsB,EAPtB,CAAP,CAD0B,CAU1B;AACD,GAlNY;AAmNb4P,iBAAe,EAAE,yBAAS/V,GAAT,EAAc;AAC7B,QAAIgW,WAAW,GAAG,CAChB,uBADgB,EACS;AACzB,2BAFgB,EAES;AACzB,2BAHgB,CAGS;AAHT,KAAlB;AAKA,WAAOhW,GAAG,CAACmG,OAAJ,CACL,IAAI8P,MAAJ,CAAWD,WAAW,CAACrX,IAAZ,CAAiB,GAAjB,CAAX,EAAkC,GAAlC,CADK,EAEL,UAASuX,KAAT,EAAgB;AACd,UAAItO,CAAC,GAAGuO,kBAAkB,CAACD,KAAD,CAAlB,CAA0BE,KAA1B,CAAgC,GAAhC,CAAR;AAAA,UACEC,CAAC,GAAG,CAAEC,QAAQ,CAAC1O,CAAC,CAAC,CAAD,CAAF,EAAO,EAAP,CAAR,GAAqB,IAAvB,KACC,CAAC0O,QAAQ,CAAC1O,CAAC,CAAC,CAAD,CAAF,EAAO,EAAP,CAAR,GAAqB,IAAtB,KAA+B,EADhC,KAEC,CAAC0O,QAAQ,CAAC1O,CAAC,CAAC,CAAD,CAAF,EAAO,EAAP,CAAR,GAAqB,IAAtB,KAA+B,CAFhC,KAGC0O,QAAQ,CAAC1O,CAAC,CAAC,CAAD,CAAF,EAAO,EAAP,CAAR,GAAqB,IAHtB,CADN;AAKA,aAAO,OAAOyO,CAAC,CAACE,QAAF,EAAP,GAAsB,GAA7B;AACD,KATI,CAAP;AAUD,GAnOY;AAoObC,QAAM,EAAE,gBAASxW,GAAT,EAAc;AACpB,WAAO,KAAK6V,UAAL,CAAgB7V,GAAhB,EACJyW,WADI,GAEJtQ,OAFI,CAEI,eAFJ,EAEqB,EAFrB,EAGJA,OAHI,CAGI,WAHJ,EAGiB,GAHjB,EAIJA,OAJI,CAII,IAAI8P,MAAJ,CAAW,0DAAX,EAAuE,IAAvE,CAJJ,EAIkF,EAJlF,EAKJ9P,OALI,CAKI,MALJ,EAKY,GALZ,CAAP;AAOD,GA5OY;AA6Ob0P,YAAU,EAAE,oBAAS7V,GAAT,EAAc;AACxB,WAAO,IAAI0W,MAAJ,CAAW1W,GAAX,EAAgBuW,QAAhB,EAAP;AACD,GA/OY;AAgPbI,YAAU,EAAE,oBAAS3W,GAAT,EAAc;AACxB,WAAO4W,MAAM,CAAC,KAAKf,UAAL,CAAgB7V,GAAhB,CAAD,CAAb;AACD,GAlPY;AAmPb6W,aAAW,EAAE,qBAASpK,KAAT,EAAgB;AAC3B,WAAO;AACLK,OAAC,EAAEgK,UAAU,CAACrK,KAAK,CAACK,CAAP,CADR;AAELF,OAAC,EAAEkK,UAAU,CAACrK,KAAK,CAACG,CAAP;AAFR,KAAP;AAID,GAxPY;AAyPbmK,YAAU,EAAE,oBAASpE,IAAT,EAAeqE,aAAf,EAA8B;AACxC,QAAIA,aAAJ,EAAmB;AACjB,aAAO;AACLlK,SAAC,EAAE+F,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,KAAWkK,aAAa,CAAClK,CAAd,EAAtB,CADE;AAELF,SAAC,EAAEiG,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,KAAWoK,aAAa,CAACpK,CAAd,EAAtB,CAFE;AAGLnE,aAAK,EAAEoK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAClK,KAAL,EAAX,CAHF;AAILC,cAAM,EAAEmK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAACjK,MAAL,EAAX;AAJH,OAAP;AAMD;;AAED,WAAO;AACLoE,OAAC,EAAE+F,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC7F,CAAL,EAAX,CADE;AAELF,OAAC,EAAEiG,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAC/F,CAAL,EAAX,CAFE;AAGLnE,WAAK,EAAEoK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAAClK,KAAL,EAAX,CAHF;AAILC,YAAM,EAAEmK,IAAI,CAACC,KAAL,CAAWH,IAAI,CAACjK,MAAL,EAAX;AAJH,KAAP;AAMD,GAzQY;AA0QbuO,aAAW,EAAE,qBAASC,KAAT,EAAgB;AAC3B,WAAO;AACLC,OAAC,EAAEtE,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACE,GAAN,KAAc,GAAzB,CADE;AAELC,OAAC,EAAExE,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACI,KAAN,KAAgB,GAA3B,CAFE;AAGLC,OAAC,EAAE1E,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACM,IAAN,KAAe,GAA1B,CAHE;AAILC,OAAC,EAAEP,KAAK,CAACQ,KAAN,EAJE;AAKL,mBAAaR,KAAK,CAACS,oBAAN,GAA6BC,oBAA7B,CAAkD,KAAlD,IAA2D,GAA3D,GAAiE/E,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACQ,KAAN,KAAgB,GAA3B,CAAjE,GAAmG,GAL3G;AAML,kBAAY,MAAM,KAAKG,KAAL,CAAWX,KAAK,CAACQ,KAAN,KAAgB,GAA3B,CAAN,GAAwCR,KAAK,CAACS,oBAAN,GAA6BC,oBAA7B,CAAkD,KAAlD,EAAyDzR,OAAzD,CAAiE,GAAjE,EAAsE,EAAtE,CAN/C;AAOL,kBAAY,UAAU,CACpB0M,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACE,GAAN,KAAc,GAAzB,CADoB,EAEpBvE,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACI,KAAN,KAAgB,GAA3B,CAFoB,EAGpBzE,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACM,IAAN,KAAe,GAA1B,CAHoB,EAInB3E,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACQ,KAAN,KAAgB,GAA3B,IAAkC,GAJf,EAKpB/Y,IALoB,CAKf,GALe,CAAV,GAKE,GAZT;AAaL,kBAAY,MAAM,CAChB,OAAO,CAACkU,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACE,GAAN,KAAc,GAAzB,IAAgC,GAAjC,EAAsCU,OAAtC,CAA8C,CAA9C,CADS,EAEhB,OAAO,CAACjF,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACI,KAAN,KAAgB,GAA3B,IAAkC,GAAnC,EAAwCQ,OAAxC,CAAgD,CAAhD,CAFS,EAGhB,OAAO,CAACjF,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACM,IAAN,KAAe,GAA1B,IAAiC,GAAlC,EAAuCM,OAAvC,CAA+C,CAA/C,CAHS,EAIhB,OAAO,CAACjF,IAAI,CAACC,KAAL,CAAWoE,KAAK,CAACQ,KAAN,KAAgB,GAA3B,IAAkC,GAAnC,EAAwCI,OAAxC,CAAgD,CAAhD,CAJS,EAKhBnZ,IALgB,CAKX,GALW,CAAN,GAKE;AAlBT,KAAP;AAoBD,GA/RY;AAgSboZ,iBAAe,EAAE,yBAASC,SAAT,EAAoB;AACnC,WAAO;AACLd,WAAK,EAAE,KAAKD,WAAL,CAAiBe,SAAS,CAACd,KAAV,EAAjB,CADF;AAELe,cAAQ,EAAED,SAAS,CAACC,QAAV;AAFL,KAAP;AAID,GArSY;AAsSbC,gBAAc,EAAE,wBAASC,QAAT,EAAmB;AACjC,QAAIC,SAAS,GAAG,EAAhB;AAAA,QACEC,IADF;AAAA,QACQC,QAAQ,GAAGH,QAAQ,CAACI,KAAT,GAAiBrJ,gBAAjB,EADnB;;AAEA,WAAOmJ,IAAI,GAAGC,QAAQ,CAAClJ,UAAT,EAAd,EAAqC;AACnCgJ,eAAS,CAAC7Z,IAAV,CAAe,KAAKwZ,eAAL,CAAqBM,IAArB,CAAf;AACD;;AAED,WAAO;AACLG,UAAI,EAAEC,aAAa,CAACN,QAAQ,CAACO,YAAT,EAAD,CADd;AAELC,UAAI,EAAE,KAAK9B,WAAL,CAAiBsB,QAAQ,CAACQ,IAAT,EAAjB,CAFD;AAGLC,QAAE,EAAE,KAAK/B,WAAL,CAAiBsB,QAAQ,CAACS,EAAT,EAAjB,CAHC;AAILC,gBAAU,EAAET;AAJP,KAAP;AAMD,GAnTY;AAoTbU,cAAY,EAAE,sBAASC,MAAT,EAAiB;AAC7B,WAAO;AACLP,UAAI,EAAEO,MAAM,YAAYC,aAAlB,GAAkC,OAAlC,GAA4C,OAD7C;AAELC,aAAO,EAAEF,MAAM,CAACE,OAAP,EAFJ;AAGLC,aAAO,EAAEH,MAAM,CAACG,OAAP,EAHJ;AAILC,gBAAU,EAAEJ,MAAM,CAACI,UAAP,EAJP;AAKLC,YAAM,EAAEL,MAAM,CAACK,MAAP,EALH;AAMLlC,WAAK,EAAE,KAAKD,WAAL,CAAiB8B,MAAM,CAAC7B,KAAP,EAAjB;AANF,KAAP;AAQD,GA7TY;AA8TbmC,YAAU,EAAE,oBAASC,GAAT,EAAc;AACxB,QAAIC,MAAM,GAAG,4CAA4Cjb,IAA5C,CAAiDgb,GAAjD,CAAb;;AAEA,QAAIC,MAAJ,EAAY;AACV,aAAOC,OAAO,CAACvR,6BAAR,CAAsCqO,QAAQ,CAACiD,MAAM,CAAC,CAAD,CAAP,EAAY,EAAZ,CAAR,GAA0B,GAAhE,EAAqEjD,QAAQ,CAACiD,MAAM,CAAC,CAAD,CAAP,EAAY,EAAZ,CAAR,GAA0B,GAA/F,EAAoGjD,QAAQ,CAACiD,MAAM,CAAC,CAAD,CAAP,EAAY,EAAZ,CAAR,GAA0B,GAA9H,EAAmI,GAAnI,CAAP;AACD,KAFD,MAEO;AACL,aAAO,IAAP;AACD;AACF,GAtUY;AAuUbE,WAAS,EAAE,mBAAShS,KAAT,EAAgB;AACzB,WAAQA,KAAK,CAAC6K,MAAN,IAAgB,KAAKvB,EAAL,CAAQtJ,KAAK,CAAC6K,MAAN,GAAeC,WAAf,EAAR,EAAsCmH,gBAAtC,CAAjB,GAA4EjS,KAAK,CAAC6K,MAAN,GAAeC,WAAf,GAA6BoH,WAA7B,EAA5E,GAAyH,CAAhI;AACD,GAzUY;AA0UbC,YAAU,EAAE,oBAASC,KAAT,EAAgB;AAC1B,QAAIC,WAAW,GAAG,EAAlB;AAAA,QACEC,MADF;AAAA,QACUC,UAAU,GAAGH,KAAK,CAACI,OAAN,GAAgB/K,gBAAhB,EADvB;;AAEA,WAAO6K,MAAM,GAAGC,UAAU,CAAC5K,UAAX,EAAhB,EAAyC;AACvC,UAAI2K,MAAM,CAACG,SAAP,EAAJ,EAAwB;AACtB,YAAIC,QAAQ,GAAGC,SAAS,CAACL,MAAM,CAACI,QAAP,EAAD,CAAxB;AAAA,YACEE,UAAU,GAAG;AACXF,kBAAQ,EAAEA,QADC;AAEXlC,kBAAQ,EAAEqC,eAAe,CAACP,MAAM,CAAC9B,QAAP,EAAD,CAFd;AAGXsC,mBAAS,EAAER,MAAM,CAACQ,SAAP;AAHA,SADf;;AAOA,gBAAQJ,QAAR;AACE,eAAK,OAAL;AACEE,sBAAU,CAACnD,KAAX,GAAmB,KAAKD,WAAL,CAAiB8C,MAAM,CAAC7C,KAAP,EAAjB,CAAnB;AACA;;AAEF,eAAK,UAAL;AACEmD,sBAAU,CAAClC,QAAX,GAAsB,KAAKD,cAAL,CAAoB6B,MAAM,CAAC5B,QAAP,EAApB,CAAtB;AACA;;AAEF;AACE;AAVJ;;AAaA2B,mBAAW,CAACvb,IAAZ,CAAiB8b,UAAjB;AACD;AACF;;AAED,WAAOP,WAAP;AACD,GAxWY;AAyWbU,UAAQ,EAAE,kBAASX,KAAT,EAAgB;AACxB,QAAIY,SAAS,GAAG,EAAhB;AAAA,QACEC,IADF;AAAA,QACQC,QAAQ,GAAGd,KAAK,CAACe,KAAN,GAAc1L,gBAAd,EADnB;;AAEA,WAAOwL,IAAI,GAAGC,QAAQ,CAACvL,UAAT,EAAd,EAAqC;AACnC,UAAIsL,IAAI,CAACR,SAAL,EAAJ,EAAsB;AACpB,YAAIC,QAAQ,GAAGC,SAAS,CAACM,IAAI,CAACP,QAAL,EAAD,CAAxB;AAAA,YACEU,QAAQ,GAAG;AACTV,kBAAQ,EAAEA;AADD,SADb;;AAKA,gBAAQA,QAAR;AACE,eAAK,OAAL;AACEU,oBAAQ,CAAC3D,KAAT,GAAiB,KAAKD,WAAL,CAAiByD,IAAI,CAACxD,KAAL,EAAjB,CAAjB;AACA;;AAEF,eAAK,UAAL;AACE2D,oBAAQ,CAAC1C,QAAT,GAAoB,KAAKD,cAAL,CAAoBwC,IAAI,CAACvC,QAAL,EAApB,CAApB;AACA;;AAEF;AACE;AAVJ;;AAaAsC,iBAAS,CAAClc,IAAV,CAAesc,QAAf;AACD;AACF;;AAED,WAAOJ,SAAP;AACD,GArYY;AAsYbK,YAAU,EAAE,oBAASjB,KAAT,EAAgB;AAC1B,QAAIkB,WAAW,GAAG,EAAlB;AAAA,QACEhC,MADF;AAAA,QACUiC,UAAU,GAAGnB,KAAK,CAACoB,OAAN,GAAgB/L,gBAAhB,EADvB;;AAEA,WAAO6J,MAAM,GAAGiC,UAAU,CAAC5L,UAAX,EAAhB,EAAyC;AACvC,UAAI2J,MAAM,CAACmB,SAAP,EAAJ,EAAwB;AACtBa,mBAAW,CAACxc,IAAZ,CAAiB,KAAKua,YAAL,CAAkBC,MAAlB,CAAjB;AACD;AACF;;AAEDiC,cAAU,GAAGnB,KAAK,CAACqB,YAAN,GAAqBhM,gBAArB,EAAb;;AACA,WAAO6J,MAAM,GAAGiC,UAAU,CAAC5L,UAAX,EAAhB,EAAyC;AACvC,UAAI2J,MAAM,CAACmB,SAAP,EAAJ,EAAwB;AACtBa,mBAAW,CAACxc,IAAZ,CAAiB,KAAKua,YAAL,CAAkBqC,OAAlB,CAAjB;AACD;AACF;;AAED,WAAOJ,WAAP;AACD,GAvZY;AAwZbK,YAAU,EAAE,oBAASvB,KAAT,EAAgB;AAC1B,WAAOA,KAAK,CAACwB,eAAN,GAAwBC,OAAxB,EAAP;AACD,GA1ZY;AA2ZbC,cAAY,EAAE,sBAAS9T,KAAT,EAAgB;AAC5B,QAAIA,KAAK,CAAC+T,WAAN,EAAJ,EAAyB;AACvB,aAAO,KAAK3F,UAAL,CAAgBpO,KAAK,CAAC+T,WAAN,GAAoBna,IAApB,EAAhB,CAAP;AACD,KAFD,MAEO;AACL,aAAO,EAAP;AACD;AACF,GAjaY;AAkaboa,UAAQ,EAAE,kBAAShU,KAAT,EAAgByP,KAAhB,EAAuBwE,mBAAvB,EAA4C;AACpD,QAAIxE,KAAJ,EAAW;AACT,UAAIzP,KAAK,CAACnI,KAAN,MAAiB8R,YAArB,EAAmC;AACjC;AACA,YAAIsK,mBAAmB,IAAI,MAA3B,EAAmC;AACjC,cAAIhB,IAAI,GAAGjT,KAAK,CAACoS,KAAN,GAAce,KAAd,GAAsBrI,WAAtB,EAAX;;AAEA,cAAImI,IAAI,IAAItU,SAAZ,EAAuB;AACrBsU,gBAAI,CAACxD,KAAL,GAAaA,KAAb;AACD;AACF;;AAED,YAAIwE,mBAAmB,IAAI,QAA3B,EAAqC;AACnC,cAAI3B,MAAM,GAAGtS,KAAK,CAACoS,KAAN,GAAcI,OAAd,GAAwB1H,WAAxB,EAAb;;AAEA,cAAIwH,MAAM,IAAI3T,SAAd,EAAyB;AACvB2T,kBAAM,CAAC7C,KAAP,GAAeA,KAAf;AACD;AACF;AACF,OAjBD,MAiBO;AACLzP,aAAK,CAACkU,SAAN,GAAkBzE,KAAlB;AACD;AACF;AACF,GAzbY;AA0bb0E,eAAa,EAAE,yBAAW;AACxB,SAAKlb,OAAL,CAAaM,QAAb,GAAwB6a,oBAAoB,CAACC,wBAArB,GAAgDC,eAAhD,EAAxB;AACA,SAAKrb,OAAL,CAAa4G,SAAb,GAAyB,KAAK5G,OAAL,CAAaM,QAAb,CAAsBqG,cAAtB,EAAzB;AAEA,WAAO,KAAK3G,OAAZ;AACD,GA/bY;AAgcbuL,SAAO,EAAE,iBAASzD,GAAT,EAAa;AACpB,QAAIwT,KAAK,GAAGzQ,KAAK,CAACC,aAAN,CAAoBhD,GAApB,CAAZ;AACAyT,eAAW,CAACC,eAAZ,GAA8BjQ,OAA9B,CAAsC+P,KAAtC;AACD;AAncY,CAAT,CAAN,C;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AAAA;AAEO,SAAS3V,MAAT,CAAgB8V,MAAhB,EAAwB9T,OAAxB,EAAiC;AACtC,MAAI8T,MAAM,GAAGA,MAAM,IAAI,EAAvB;;AAEA,OAAK,IAAIpc,GAAT,IAAgBsI,OAAhB,EAAyB;AACvB8T,UAAM,CAACpc,GAAD,CAAN,GAAcsI,OAAO,CAACtI,GAAD,CAArB;AACD;;AACD,SAAOoc,MAAP;AACD;AAEM,SAASC,WAAT,CAAqBC,GAArB,EAA0B;AAC/Bxb,gDAAM,CAACqE,KAAP,CAAaR,IAAI,CAACC,SAAL,CAAe0X,GAAf,CAAb;AACD,C;;;;;;;;;;;;ACbD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEe,yEAASC,GAAT,EAAc;AAC3B5b,yDAAO,CAACK,GAAR,CAAYub,GAAZ,EAAiB,YAAW;AAC1Bzb,yDAAM,CAACyE,QAAP,CAAgBzE,qDAAM,CAACwE,MAAP,CAAczB,KAA9B;AAEA2Y,SAAK,GAAGC,aAAR;AACD,GAJD;AAKD;AAAA;;AAED,IAAID,KAAK,GAAG,SAARA,KAAQ,GAAW;AACrB,MAAME,YAAY,GAAG,CAArB,CADqB,CAGrB;;AACA,MAAIC,OAAJ,EACEC,OADF,EAEEC,MAFF,EAGEC,KAHF,EAIEC,KAJF,CAJqB,CAUrB;;AACA,MAAIC,KAAJ,EACEC,SADF,EAEEC,UAFF;AAIA,MAAIC,cAAc,GAAG,IAArB,CAfqB,CAeM;;AAC3B,MAAIC,mBAAmB,GAAG,IAA1B,CAhBqB,CAkBrB;;AACA,MAAIC,QAAJ;AAEA,MAAI7O,GAAG,GAAG7N,uDAAO,CAACQ,OAAR,GAAkBF,QAA5B;AACA,MAAIqc,cAAc,GAAG9O,GAAG,CAAC1H,WAAJ,GAAkByW,eAAlB,MAAuC/O,GAAG,CAAC1H,WAAJ,EAA5D;;AAEA,MAAI0W,cAAc,GAAG,SAAjBA,cAAiB,GAAW;AAC9B,QAAIC,WAAW,GAAG,IAAlB;AACA,QAAIC,GAAG,GAAG/c,uDAAO,CAACQ,OAAR,GAAkBoG,SAA5B;AACA,QAAIoW,QAAQ,GAAGD,GAAG,CAACjW,KAAJ,EAAf;;AACA,QAAIkW,QAAQ,IAAI,CAAhB,EAAmB;AACjB,UAAI/W,qDAAM,CAACoK,EAAP,CAAU0M,GAAG,CAAC,CAAD,CAAb,EAAkBtM,YAAlB,CAAJ,EAAqC;AACnCqM,mBAAW,GAAGjY,yDAAQ,CAAC0B,UAAT,CAAoBwW,GAAG,CAAC,CAAD,CAAvB,CAAd;AACA5c,6DAAM,CAACqE,KAAP,CAAa,gBAAb,EAA+BsY,WAA/B;AACD;;AAED,UAAIN,cAAc,IAAI,IAAtB,EAA4B;AAAE;AAC5B,YAAI,CAACvW,qDAAM,CAACoK,EAAP,CAAU0M,GAAG,CAAC,CAAD,CAAb,EAAkB7O,eAAlB,CAAL,EAAyC;AACvCuO,6BAAmB,GAAGM,GAAG,CAAC,CAAD,CAAzB;AACD;AACF;AACF;;AAEDE,eAAW,CAAC,UAASvZ,IAAT,EAAe;AACzBwZ,yBAAmB,CAACxZ,IAAD,CAAnB;;AACAyZ,mBAAa;;AACbC,kBAAY;;AACZC,kBAAY;;AACZC,oBAAc;;AACdC,mBAAa;;AACbC,eAAS;;AACTC,uBAAiB;;AACjBC,6BAAuB;AACxB,KAVU,EAURZ,WAVQ,CAAX;AAWD,GA5BD;;AA8BA,MAAIG,WAAW,GAAG,SAAdA,WAAc,CAAS9U,QAAT,EAAmBzE,IAAnB,EAAyB;AACzC,WAAO0D,mDAAK,CAACoG,WAAN,CAAkB;AACvB1F,SAAG,EAAE9H,uDAAO,CAACY,aAAR,KAA0B,sCADR;AAEvBmH,WAAK,EAAE,IAFgB;AAGvBC,YAAM,EAAE,GAHe;AAIvBtE,UAAI,EAAEA,IAJiB;AAKvB+E,gBAAU,EAAE,2BALW;AAMvBR,iBAAW,EAAE,KANU;AAOvBE,cAAQ,EAAEA;AAPa,KAAlB,CAAP;AASD,GAVD;;AAYA,MAAI+U,mBAAmB,GAAG,SAAtBA,mBAAsB,CAASxZ,IAAT,EAAe;AACvC,QAAIia,oBAAoB,GAAG,SAAvBA,oBAAuB,CAASre,GAAT,EAAcse,GAAd,EAAmB;AAC5C,aAAOte,GAAG,CAACoW,KAAJ,CAAUkI,GAAV,CAAP;AACD,KAFD;;AAIA5B,WAAO,GAAG2B,oBAAoB,CAACja,IAAI,CAACsY,OAAN,EAAe,GAAf,CAA9B;AACAC,WAAO,GAAGjY,IAAI,CAACsB,KAAL,CAAW5B,IAAI,CAACma,KAAhB,CAAV;AACA3B,UAAM,GAAGyB,oBAAoB,CAACja,IAAI,CAACwY,MAAN,EAAc,GAAd,CAA7B;AACAC,SAAK,GAAGwB,oBAAoB,CAACja,IAAI,CAACyY,KAAN,EAAa,GAAb,CAA5B;AACAC,SAAK,GAAGpY,IAAI,CAACsB,KAAL,CAAW5B,IAAI,CAAC0Y,KAAhB,CAAR;AACD,GAVD;;AAYA,MAAIe,aAAa,GAAG,SAAhBA,aAAgB,GAAW;AAC7BT,YAAQ,GAAGT,OAAO,CAAC,CAAD,CAAP,CAAWne,MAAtB;AACAqC,yDAAM,CAACqE,KAAP,CAAa,gBAAgBkY,QAA7B;AACD,GAHD;;AAKA,MAAIU,YAAY,GAAG,SAAfA,YAAe,GAAW;AAC5Bb,cAAU,GAAGtW,qDAAM,CAACuK,QAAP,EAAb;AACA+L,cAAU,CAACuB,OAAX,CAAmB,OAAnB;AACD,GAHD;;AAKA,MAAIT,YAAY,GAAG,SAAfA,YAAe,GAAW;AAC5BxY,6DAAQ,CAAC2B,UAAT,CAAoB4V,KAApB,EAA2BG,UAA3B;AACD,GAFD;;AAIA,MAAIe,cAAc,GAAG,SAAjBA,cAAiB,GAAW;AAC9B,QAAIlB,KAAK,CAAC2B,aAAN,IAAuB,KAA3B,EAAkC;AAChC;AACD;;AAED,QAAI3J,MAAM,GAAG3G,qDAAM,CAAC6B,iBAAP,CAAyB,oBAAzB,EAA+C,CAA/C,CAAb;AACA,QAAI0D,QAAQ,GAAGoB,MAAM,CAAC4J,iBAAP,EAAf;AACAhL,YAAQ,CAAC8K,OAAT,CAAiB,QAAjB;AAEAvB,cAAU,CAACnW,SAAX,CAAqB,CAAC4M,QAAD,CAArB;AAEA,QAAIf,IAAI,GAAGhM,qDAAM,CAAC0M,OAAP,CAAeK,QAAf,CAAX;AACAf,QAAI,CAACO,IAAL,CAAU,GAAV;AACAP,QAAI,CAACM,IAAL,CAAU,CAAV,EAb8B,CAe9B;AACA;AACD,GAjBD;;AAmBA,MAAIgL,aAAa,GAAG,SAAhBA,aAAgB,GAAW;AAC7BjB,aAAS,GAAGrW,qDAAM,CAACC,QAAP,EAAZ;AACAoW,aAAS,CAACwB,OAAV,CAAkB,MAAlB;AACA7X,yDAAM,CAACsL,SAAP,CAAiB+K,SAAjB,EAH6B,CAI7B;AACE;;AACA,QAAI2B,SAAS,GAAGxQ,qDAAM,CAAC+B,oBAAP,CAA4B,kBAA5B,CAAhB;AACA8M,aAAS,CAAC4B,cAAV,CAAyBD,SAAzB,EAP2B,CAQ7B;;AACA,QAAIE,QAAQ,GAAGlY,qDAAM,CAAC0M,OAAP,CAAe2J,SAAf,CAAf;AAEA,QAAIlI,MAAM,GAAG3G,qDAAM,CAAC6B,iBAAP,CAAyB,mBAAzB,EAA8C,CAA9C,CAAb;AACA+M,SAAK,GAAGjI,MAAM,CAAC4J,iBAAP,EAAR;AACA3B,SAAK,CAACyB,OAAN,CAAc,OAAd;AACA,QAAIM,SAAS,GAAGnY,qDAAM,CAAC0M,OAAP,CAAe0J,KAAf,CAAhB;AAEA8B,YAAQ,CAAC1L,QAAT,CAAkB2L,SAAS,CAACrW,KAA5B;AACAoW,YAAQ,CAACzL,SAAT,CAAmB0L,SAAS,CAACpW,MAA7B;AAEAuU,cAAU,CAACnW,SAAX,CAAqB,CAACkW,SAAD,EAAYD,KAAZ,CAArB;AAEAM,kBAAc,CAAC0B,QAAf,CAAwB9B,UAAxB;AACD,GAtBD;;AAwBA,MAAIiB,SAAS,GAAG,SAAZA,SAAY,GAAW;AACzB,QAAIpR,CAAC,GAAG2P,YAAR;AACA,QAAI3H,MAAM,GAAG3G,qDAAM,CAAC6B,iBAAP,CAAyB,8BAAzB,EAAyD,CAAzD,CAAb;AACA,QAAIgP,YAAY,GAAG7Q,qDAAM,CAAC6B,iBAAP,CAAyB,kCAAzB,EAA6D,CAA7D,CAAnB;AACA,QAAIiP,UAAU,GAAG9Q,qDAAM,CAAC6B,iBAAP,CAAyB,yBAAzB,EAAoD,CAApD,CAAjB;;AAEA,QAAI8M,KAAK,CAACoC,aAAN,IAAuB,IAA3B,EAAiC;AAC/B,UAAIC,YAAY,GAAGhR,qDAAM,CAAC6B,iBAAP,CAAyB,2BAAzB,EAAsD,CAAtD,CAAnB;AACA,UAAI0D,QAAQ,GAAGyL,YAAY,CAACT,iBAAb,EAAf;AACAhL,cAAQ,CAAC8K,OAAT,CAAiB,eAAjB;AACAvB,gBAAU,CAACnW,SAAX,CAAqB,CAAC4M,QAAD,CAArB;AACA,UAAIf,IAAI,GAAGhM,qDAAM,CAAC0M,OAAP,CAAeK,QAAf,CAAX;AACAf,UAAI,CAACM,IAAL,CAAUnG,CAAV;AACAA,OAAC,IAAI6F,IAAI,CAAClK,KAAV;AACD;;AAED,QAAIqW,SAAS,GAAGnY,qDAAM,CAAC0M,OAAP,CAAe0J,KAAf,CAAhB;AACA,QAAIqC,UAAU,GAAGN,SAAS,CAACrW,KAA3B;;AAEA,SAAK,IAAI8H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmM,OAAO,CAACle,MAA5B,EAAoC+R,CAAC,EAArC,EAAyC;AACvC,UAAI8O,MAAM,GAAG3C,OAAO,CAACnM,CAAD,CAApB;AAEA,UAAI+O,MAAM,GAAG,KAAb;AACA,UAAIC,YAAY,GAAG,IAAIC,GAAJ,CAAQ7C,OAAO,CAACpM,CAAD,CAAf,CAAnB;AACAgP,kBAAY,CAACE,MAAb,CAAoB,EAApB;;AACA,UAAIF,YAAY,CAACG,IAAb,IAAqB,CAArB,IAA0BH,YAAY,CAACI,GAAb,CAAiB,GAAjB,CAA9B,EAAqD;AACnDL,cAAM,GAAG,IAAT;AACD;;AAED,UAAI5L,QAAQ,GAAGoB,MAAM,CAAC4J,iBAAP,EAAf;;AACA,UAAI7B,KAAK,CAACtM,CAAD,CAAL,IAAY,SAAhB,EAA2B;AACzBmD,gBAAQ,GAAGsL,YAAY,CAACN,iBAAb,EAAX;AACD,OAFD,MAEO,IAAIY,MAAJ,EAAY;AACjB5L,gBAAQ,GAAGuL,UAAU,CAACP,iBAAX,EAAX;AACD;;AAEDhL,cAAQ,CAAC8K,OAAT,CAAiBa,MAAM,GAAG,SAA1B;AACApC,gBAAU,CAACnW,SAAX,CAAqB,CAAC4M,QAAD,CAArB;AACA/M,2DAAM,CAACiL,cAAP,CAAsBqL,UAAtB,EAAkCF,KAAlC,EAAyCrJ,QAAzC;AAEA,UAAIkM,cAAc,GAAG;AAAC,iBAASP;AAAV,OAArB;;AACA,UAAI9O,CAAC,IAAImM,OAAO,CAACle,MAAR,GAAiB,CAA1B,EAA6B;AAC3BohB,sBAAc,CAAC,aAAD,CAAd,GAAgC;AAAC,sBAAYjZ,qDAAM,CAAC6M;AAApB,SAAhC;AACD;;AACD,WAAK,IAAI0B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3B,YAAI7V,KAAK,GAAGsd,OAAO,CAACpM,CAAD,CAAP,CAAW2E,CAAX,CAAZ;;AACA,YAAI4H,KAAK,CAAC+C,gBAAN,IAA0B,KAA1B,IAAmCxgB,KAAK,IAAI,EAAhD,EAAoD;AAAEA,eAAK,GAAG,GAAR;AAAc;;AACpE,YAAIigB,MAAM,IAAIjgB,KAAK,CAACoX,WAAN,MAAuB,GAArC,EAA0C;AACxC5V,+DAAM,CAACqE,KAAP,CAAa,mCAAmCgQ,CAAC,GAAG,CAAvC,CAAb;AACA7V,eAAK,GAAG;AAAC,wBAAYsH,qDAAM,CAAC6M;AAApB,WAAR;AACD;;AACDoM,sBAAc,CAAC,UAAU1K,CAAC,GAAG,CAAd,CAAD,CAAd,GAAmC7V,KAAnC;AACD;;AACDsH,2DAAM,CAAC8M,eAAP,CAAuBC,QAAvB,EAAiCkM,cAAjC;AAEA,UAAInX,KAAK,GAAGoK,IAAI,CAACC,KAAL,CAAWwD,QAAQ,CAACsG,MAAM,CAACrM,CAAD,CAAP,CAAR,GAAsB,CAAjC,IAAsC,CAAlD;;AACA,UAAIA,CAAC,IAAImM,OAAO,CAACle,MAAR,GAAiB,CAAtB,IAA2BsO,CAAC,GAAGrE,KAAJ,GAAY2W,UAA3C,EAAuD;AACrD3W,aAAK,GAAG2W,UAAU,GAAGtS,CAAb,GAAiB2P,YAAzB;AACD;;AACD,UAAIqD,UAAU,GAAGnZ,qDAAM,CAAC0M,OAAP,CAAeK,QAAf,CAAjB;AACAoM,gBAAU,CAAC7M,IAAX,CAAgBnG,CAAhB;AACAgT,gBAAU,CAAC3M,QAAX,CAAoB1K,KAApB;AAEAqE,OAAC,IAAIrE,KAAL;AACD;AACF,GAjED;;AAmEA,MAAI0V,iBAAiB,GAAG,SAApBA,iBAAoB,GAAW;AACjClB,cAAU,CAAC3J,uBAAX,CAAmC,KAAnC;AAEA2J,cAAU,CAAC8C,2BAAX,CAAuC,IAAvC,EAA6C,IAA7C;AACD,GAJD;;AAMA,MAAI3B,uBAAuB,GAAG,SAA1BA,uBAA0B,GAAW;AACvC,QAAIlB,cAAc,IAAI,IAAtB,EAA4B;AAC1B;;;;;;;;AAQD,KATD,MASO,IAAIC,mBAAmB,IAAI,IAA3B,EAAiC;AACtCxW,2DAAM,CAACiL,cAAP,CAAsByL,cAAtB,EAAsCF,mBAAtC,EAA2DF,UAA3D;AACA,UAAI+C,SAAS,GAAGrZ,qDAAM,CAAC0M,OAAP,CAAe8J,mBAAf,CAAhB;AACA,UAAI8C,cAAc,GAAGtZ,qDAAM,CAAC0M,OAAP,CAAe4J,UAAf,CAArB;AACAgD,oBAAc,CAAChN,IAAf,CAAoB+M,SAAS,CAAClT,CAA9B;AACAmT,oBAAc,CAAC/M,IAAf,CAAoB8M,SAAS,CAACpT,CAA9B;AACD;;AAEDqQ,cAAU,CAAC8C,2BAAX,CAAuC,IAAvC,EAA6C,KAA7C,EAlBuC,CAmBvC;AACD,GApBD;;AAsBA,SAAO;AACLvD,iBAAa,EAAE,yBAAW;AACxBe,oBAAc;AACf;AAHI,GAAP;AAKD,CA3OD,C","file":"rivet-table.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/rivet-table.js\");\n","//\n//  MochaJSDelegate.js\n//  MochaJSDelegate\n//\n//  Created by Matt Curtis\n//  Copyright (c) 2015. All rights reserved.\n//\n\nexport default function (selectorHandlerDict) {\n\tvar uniqueClassName = \"MochaJSDelegate_DynamicClass_\" + NSUUID.UUID().UUIDString();\n\n\tvar delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName, NSObject);\n\n\tdelegateClassDesc.registerClass();\n\n\t//\tHandler storage\n\n\tvar handlers = {};\n\n\t//\tDefine interface\n\n\tthis.setHandlerForSelector = function (selectorString, func) {\n\t\tvar handlerHasBeenSet = (selectorString in handlers);\n\t\tvar selector = NSSelectorFromString(selectorString);\n\n\t\thandlers[selectorString] = func;\n\n\t\tif (!handlerHasBeenSet) {\n\t\t\t/*\n\t\t\t\tFor some reason, Mocha acts weird about arguments:\n\t\t\t\thttps://github.com/logancollins/Mocha/issues/28\n\n\t\t\t\tWe have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n\t\t\t*/\n\n\t\t\tvar dynamicHandler = function () {\n\t\t\t\tvar functionToCall = handlers[selectorString];\n\n\t\t\t\tif (!functionToCall) return;\n\n\t\t\t\treturn functionToCall.apply(delegateClassDesc, arguments);\n\t\t\t};\n\n\t\t\tvar args = [], regex = /:/g;\n\t\t\twhile (regex.exec(selectorString)) {\n\t\t\t\targs.push(\"arg\" + args.length);\n\t\t\t}\n\n\t\t\tvar dynamicFunction = eval(\"(function(\" + args.join(\",\") + \"){ return dynamicHandler.apply(this, arguments); })\");\n\n\t\t\tdelegateClassDesc.addInstanceMethodWithSelector_function_(selector, dynamicFunction);\n\t\t}\n\t};\n\n\tthis.removeHandlerForSelector = function (selectorString) {\n\t\tdelete handlers[selectorString];\n\t};\n\n\tthis.getHandlerForSelector = function (selectorString) {\n\t\treturn handlers[selectorString];\n\t};\n\n\tthis.getAllHandlers = function () {\n\t\treturn handlers;\n\t};\n\n\tthis.getClass = function () {\n\t\treturn NSClassFromString(uniqueClassName);\n\t};\n\n\tthis.getClassInstance = function () {\n\t\treturn NSClassFromString(uniqueClassName).new();\n\t};\n\n\t//\tConveience\n\n\tif (typeof selectorHandlerDict == \"object\") {\n\t\tfor (var selectorString in selectorHandlerDict) {\n\t\t\tthis.setHandlerForSelector(selectorString, selectorHandlerDict[selectorString]);\n\t\t}\n\t}\n};\n","export function coerceJS(value) {\n  if (value) {\n    if (value.class) {\n      switch (coerceString(value.class())) {\n        case '__NSCFString':\n        case '__NSCFConstantString':\n        case 'NSTaggedPointerString':\n        case 'NSPathStore2':\n          return coerceString(value);\n        case '__NSCFDictionary':\n        case '__NSDictionaryI':\n          return coerceObject(value);\n        case '__NSCFArrayI':\n        case '__NSArrayM':\n          return coerceArray(value);\n        case '__NSCFNumber':\n          return coerceNumber(value);\n        default: return value;\n      }\n    } else if (Array.isArray(value)) {\n      return value.map(coerceJS);\n    } else if (typeof value === 'object') {\n      const newObj = {};\n      for (var key in value) {\n        newObj[key] = coerceJS(value[key]);\n      }\n      return newObj;\n    }\n  }\n\n  return value;\n}\n\nexport function coerceString(str) {\n  if (str) {\n    return '' + str;\n  } else {\n    return null;\n  }\n}\n\nexport function coerceNumber(number) {\n  return number + 0;\n}\n\nexport function coerceBool(number) {\n  return !!(number + 0);\n}\n\nexport function coerceArray(array) {\n  var result = [];\n  $.forEach(array, function(item) {\n    result.push(coerceJS(item));\n  });\n  return result;\n}\n\nexport function coerceObject(dict) {\n  var result = {};\n  $.forEach(dict.allKeys(), function(key) {\n    result[key] = coerceJS(dict[key]);\n  });\n  return result;\n}\n","import { logger } from './logger';\n\nexport const context = (function() {\n  var currentContext;\n\n  function init(context) {\n    currentContext = context;\n    logger.info('Context initialized');\n  }\n\n  function run(context, func) {\n    // try {\n      init(context);\n\n      func(context, context.document);\n    // } catch (e) {\n    //   logger.error(e);\n    //   displayDialog(\"Error: \" + e);\n    // }\n\n    complete();\n  }\n\n  function current() {\n    if (currentContext == null) {\n      throw 'Context not set. Call init(context) first.';\n    }\n    return currentContext;\n  }\n\n  function getCommandName() {\n    if (currentContext != null) {\n      return currentContext.command.name();\n    }\n    return null;\n  }\n\n  function getPluginRoot() {\n    if (currentContext == null) {\n      throw 'Context not set. Call init(context) first.';\n    }\n    var pluginRoot = currentContext.scriptPath\n      .stringByDeletingLastPathComponent()\n      .stringByDeletingLastPathComponent()\n      .stringByDeletingLastPathComponent();\n    return pluginRoot;\n  }\n\n  function displayDialog(body) {\n    logger.log('SHOW DIALOG: ' + body);\n\t\tvar app = NSApplication.sharedApplication();\n\t\tapp.displayDialog_withTitle(body, getCommandName());\n\t}\n\n  function tryCurrent() {\n    return currentContext;\n  }\n\n  function complete() {\n    logger.info('Plugin run complete');\n  }\n\n  return {\n    init: init,\n    run: run,\n    current: current,\n    getCommandName: getCommandName,\n    getPluginRoot: getPluginRoot,\n    displayDialog: displayDialog,\n    tryCurrent: tryCurrent,\n    complete: complete\n  };\n})();\n","function createCocoaObject(methods, superclass) {\n    var uniqueClassName = \"MD.sketch_\" + NSUUID.UUID().UUIDString();\n    var classDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName, superclass || NSObject);\n    classDesc.registerClass();\n    for (var selectorString in methods) {\n        var selector = NSSelectorFromString(selectorString);\n        classDesc.addInstanceMethodWithSelector_function(selector, methods[selectorString]);\n    }\n    return NSClassFromString(uniqueClassName).new();\n}\n\nexport function addFirstMouseAcceptor(webView, contentView) {\n    var button = createCocoaObject({\n        'mouseDown:': function (evt) {\n            // Remove this view. Subsequent events such the mouseUp event that will\n            // probably immediately follow mouseDown or any other mouse events will\n            // be handled as if this view is not here because it will not be here!\n            this.removeFromSuperview();\n\n            // Now send the same mouseDown event again as if the user had just\n            // clicked. With the button gone, this will be handled by the WebView.\n            NSApplication.sharedApplication().sendEvent(evt);\n        },\n    }, NSButton);\n\n    button.setIdentifier('firstMouseAcceptor');\n    button.setTransparent(true);\n    button.setTranslatesAutoresizingMaskIntoConstraints(false);\n\n    contentView.addSubview(button);\n\n    var views = {\n        button: button,\n        webView: webView\n    };\n\n    // Match width of WebView.\n    contentView.addConstraints(\n        NSLayoutConstraint.constraintsWithVisualFormat_options_metrics_views(\n            'H:[button(==webView)]',\n            NSLayoutFormatDirectionLeadingToTrailing,\n            null,\n            views)\n    );\n\n    // Match height of WebView.\n    contentView.addConstraints(\n        NSLayoutConstraint.constraintsWithVisualFormat_options_metrics_views(\n            'V:[button(==webView)]',\n            NSLayoutFormatDirectionLeadingToTrailing,\n            null,\n            views)\n    );\n\n    // Match top of WebView.\n    contentView.addConstraints(\n        NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n            button,\n            NSLayoutAttributeTop,\n            NSLayoutRelationEqual,\n            webView,\n            NSLayoutAttributeTop,\n            1,\n            0)\n    );\n}\n","import { context } from './context';\n\nexport const logger = (function() {\n  var _levels = {\n    DEBUG: 1,\n    INFO: 2,\n    WARN: 3,\n    ERROR: 4\n  };\n\n  var _logLevel = _levels.INFO;\n\n  function _log(level, message, data) {\n    if (level >= _logLevel) {\n      var now = new Date();\n      var prefix = '';\n      if (context && context.getCommandName() != null) {\n        prefix = context.getCommandName() + ' - ';\n      }\n      var levelString = '';\n      switch (level) {\n        case 1:\n          levelString = 'DEBUG';\n          break;\n        case 2:\n          levelString = 'INFO';\n          break;\n        case 3:\n          levelString = 'WARN';\n          break;\n        case 4:\n          levelString = 'ERROR';\n          break;\n        default:\n          levelString = 'UNKNOWN';\n      }\n      var dataString = '';\n      if (data != null) {\n        dataString = ' - ' + JSON.stringify(data);\n      }\n      log(now.toISOString() + ' ' + prefix + levelString + ': ' + message + dataString);\n    }\n  }\n\n  function _debug(message, data) {\n    _log(_levels.DEBUG, message, data);\n  }\n\n  function _info(message, data) {\n    _log(_levels.INFO, message, data);\n  }\n\n  function _warn(message, data) {\n    _log(_levels.WARN, message, data);\n  }\n\n  function _error(message, data) {\n    _log(_levels.ERROR, message, data);\n  }\n\n  function _setLevel(level) {\n    _logLevel = level;\n  }\n\n  return {\n    log: _info,\n    debug: _debug,\n    info: _info,\n    warn: _warn,\n    error: _error,\n    levels: _levels,\n    setLevel: _setLevel\n  };\n})();\n","import { context } from './context';\nimport { logger } from './logger';\nimport { sketch } from './sketch';\nimport { extend } from './util';\n\nexport const metadata = (function() {\n  const KEY = 'RivetConfig';\n\n  var _getUIMetadata = function() {\n    return context.current().document.mutableUIMetadata();\n  };\n\n  var _getConfigs = function(container) {\n    var configsData;\n    if (container) {\n      configsData = context.current().command.valueForKey_onLayer(KEY, container);\n    } else {\n      configsData = _getUIMetadata().objectForKey(KEY);\n    }\n\n    return JSON.parse(configsData);\n  };\n\n  var _setConfigs = function(newConfigs, container, replace) {\n    var configsData = newConfigs || {};\n    if (replace == undefined || replace != true) {\n      configsData = extend(_getConfigs(container) || {}, newConfigs);\n    }\n    configsData.timestamp = new Date().getTime();\n\n    if (container) {\n      context.current().command.setValue_forKey_onLayer(JSON.stringify(configsData), KEY, container);\n    } else {\n      _getUIMetadata().setObject_forKey(JSON.stringify(configsData), KEY);\n    }\n\n    var saveDoc = sketch.addShape();\n    context.current().document.currentPage().addLayers([saveDoc]);\n    sketch.removeLayer(saveDoc);\n\n    return configsData;\n  };\n\n  var _removeConfigs = function(container) {\n    if (container) {\n      context.current().command.setValue_forKey_onLayer({}, KEY, container);\n    } else {\n      _getUIMetadata().setObject_forKey({}, KEY);\n    }\n  }\n\n  return {\n    getConfigs: _getConfigs,\n    setConfigs: _setConfigs,\n    removeConfigs: _removeConfigs\n  };\n})();\n\nconst testMetadata = function(context) {\n  context.run(context, function(context) {\n    logger.setLevel(logger.levels.DEBUG);\n\n    var selectedLayers = context.selection;\n    var selectedCount = selectedLayers.count();\n    if (selectedCount > 0) {\n      var layer = selectedLayers[0];\n      logger.debug('layer');\n      metadata.removeConfigs(layer)\n      logger.debug('  get md', metadata.getConfigs(layer));\n      logger.debug('  set md', metadata.setConfigs({prop1: \"abc\", prop2: 5}, layer));\n      logger.debug('  get md', metadata.getConfigs(layer));\n      var c = metadata.getConfigs(layer);\n      delete c.prop1;\n      c.prop3 = \"def\";\n      logger.debug('  set md', metadata.setConfigs(c, layer, false));\n      logger.debug('  get md', metadata.getConfigs(layer));\n      //logger.debug('  rem md', metadata.removeConfigs(layer));\n    }\n\n    logger.debug('global');\n    metadata.removeConfigs()\n    logger.debug('  get md', metadata.getConfigs());\n    logger.debug('  set md', metadata.setConfigs({prop1: \"abc\", prop2: 5}));\n    logger.debug('  get md', metadata.getConfigs());\n    logger.debug('  set md', metadata.setConfigs({prop3: \"def\", prop1: null}));\n    logger.debug('  get md', metadata.getConfigs());\n    //logger.debug('  rem md', metadata.removeConfigs());\n  });\n};\n","import { logger } from './logger';\nimport { extend } from './util';\nimport MochaJSDelegate from './MochaJSDelegate';\nimport { addFirstMouseAcceptor } from './first-mouse-acceptor';\n\nexport const panel = (function () {\n  const TITLE_BG_COLOR = NSColor.colorWithRed_green_blue_alpha(21 / 255, 117 / 255, 213 / 255, 1);\n\n  coscript.setShouldKeepAround(false);\n\n  function _createPanel(options) {\n    var self = this,\n      threadDictionary,\n      options = extend({\n        url: undefined,\n        width: 240,\n        height: 316,\n        floatWindow: false,\n        hiddenClose: false,\n        data: null,\n        callback: function (data) { return data; }\n      }, options),\n      result = false;\n\n    if (!options.remote) {\n      options.url = encodeURI(\"file://\" + options.url);\n    }\n\n    var frame = NSMakeRect(0, 0, options.width, (options.height + 32)),\n      contentBgColor = NSColor.colorWithRed_green_blue_alpha(1, 1, 1, 1);\n\n    if (options.identifier) {\n      threadDictionary = NSThread.mainThread().threadDictionary();\n      if (threadDictionary[options.identifier]) {\n        COScript.currentCOScript().setShouldKeepAround_(true);\n        return;\n      }\n    }\n\n    const Panel = NSPanel.alloc().init();\n\n    // var Panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(frame, 31, 2, 'YES');\n    Panel.setTitleVisibility(NSWindowTitleHidden);\n    Panel.setTitlebarAppearsTransparent(true);\n    Panel.standardWindowButton(NSWindowCloseButton).setHidden(options.hiddenClose);\n    Panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true);\n    Panel.standardWindowButton(NSWindowZoomButton).setHidden(true);\n    Panel.setFrame_display(frame, true);\n    Panel.setBackgroundColor(contentBgColor);\n    Panel.setWorksWhenModal(true);\n\n    if (options.floatWindow) {\n      Panel.becomeKeyWindow();\n      Panel.setLevel(NSFloatingWindowLevel);\n      threadDictionary[options.identifier] = Panel;\n      // Long-running script\n      COScript.currentCOScript().setShouldKeepAround_(true);\n    }\n\n    var contentView = Panel.contentView(),\n      webView = WebView.alloc().initWithFrame(NSMakeRect(0, 0, options.width, options.height));\n\n    var windowObject = webView.windowScriptObject();\n\n    contentView.setWantsLayer(true);\n    contentView.layer().setFrame(contentView.frame());\n    // contentView.layer().setCornerRadius(6);\n    // contentView.layer().setMasksToBounds(true);\n\n    webView.setBackgroundColor(contentBgColor);\n    webView.setMainFrameURL_(options.url);\n    contentView.addSubview(webView);\n\n    var delegate = new MochaJSDelegate({\n      \"webView:didFinishLoadForFrame:\": (function (webView, webFrame) {\n        var MDAction = [\n          \"function MDAction(hash, data) {\",\n          \"if (data) { window.MDData = encodeURI(JSON.stringify(data)); }\",\n          \"window.location.hash = hash;\",\n          \"}\"\n        ].join(\"\"),\n          DOMReady = [\n            \"$(\", \"function() {\", \"init(\" + JSON.stringify(options.data) + \");\", \"}\", \");\"\n          ].join(\"\");\n\n        if (!options.remote) {\n          windowObject.evaluateWebScript(MDAction);\n          windowObject.evaluateWebScript(DOMReady);\n        }\n      }),\n      \"webView:didChangeLocationWithinPageForFrame:\": (function (webView, webFrame) {\n        var request = NSURL.URLWithString(webView.mainFrameURL()).fragment();\n\n        if (request == \"submit\") {\n          var data = JSON.parse(decodeURI(windowObject.valueForKey(\"MDData\")));\n          try {\n            options.callback(data);\n          } catch (e) {\n            logger.error(e);\n          }\n          result = true;\n          if (!options.floatWindow) {\n            windowObject.evaluateWebScript(\"window.location.hash = 'close';\");\n          }\n        }\n\n        if (request == 'drag-end') {\n          var data = JSON.parse(decodeURI(windowObject.valueForKey(\"draggedIcon\")));\n          MD.Importer().convertSvgToSymbol(data);\n          result = true;\n        }\n\n        if (request == 'changeLink') {\n          var data = JSON.parse(decodeURI(windowObject.valueForKey(\"currentLink\")));\n          MD.openURL(data);\n        }\n\n        if (request == 'applyStyles') {\n          var data = JSON.parse(decodeURI(windowObject.valueForKey(\"appliedStyles\")));\n          MD.Typography().applyTypographyStyles(data);\n        }\n\n        if (request == 'onWindowDidBlur') {\n          addFirstMouseAcceptor(webView, contentView);\n        }\n\n        if (request == \"close\") {\n          if (!options.floatWindow) {\n            Panel.orderOut(nil);\n            NSApp.stopModal();\n          }\n          else {\n            Panel.close();\n          }\n        }\n\n        if (request == \"focus\") {\n          var point = Panel.currentEvent().locationInWindow(),\n            y = NSHeight(Panel.frame()) - point.y - 32;\n          windowObject.evaluateWebScript(\"lookupItemInput(\" + point.x + \", \" + y + \")\");\n        }\n        windowObject.evaluateWebScript(\"window.location.hash = '';\");\n      })\n    });\n\n    webView.setFrameLoadDelegate_(delegate.getClassInstance());\n    // NSButton already returns YES for -acceptsFirstMouse: so all we need to do\n    // is handle the mouseDown event.\n    if (options.floatWindow) {\n      Panel.center();\n      Panel.makeKeyAndOrderFront(nil);\n    }\n\n    var closeButton = Panel.standardWindowButton(NSWindowCloseButton);\n    closeButton.setCOSJSTargetFunction(function (sender) {\n      var request = NSURL.URLWithString(webView.mainFrameURL()).fragment();\n\n      if (options.floatWindow && request == \"submit\") {\n        data = JSON.parse(decodeURI(windowObject.valueForKey(\"MDData\")));\n        options.callback(data);\n      }\n\n      if (options.identifier) {\n        threadDictionary.removeObjectForKey(options.identifier);\n      }\n\n      self.wantsStop = true;\n      if (options.floatWindow) {\n        Panel.close();\n      }\n      else {\n        Panel.orderOut(nil);\n        NSApp.stopModal();\n      }\n\n    });\n    closeButton.setAction(\"callAction:\");\n\n    var titlebarView = contentView.superview().titlebarViewController().view(),\n      titlebarContainerView = titlebarView.superview();\n    closeButton.setFrameOrigin(NSMakePoint(8, 8));\n    titlebarContainerView.setFrame(NSMakeRect(0, options.height, options.width, 32));\n    titlebarView.setFrameSize(NSMakeSize(options.width, 32));\n    titlebarView.setTransparent(true);\n    titlebarView.setBackgroundColor(TITLE_BG_COLOR);\n    titlebarContainerView.superview().setBackgroundColor(TITLE_BG_COLOR);\n\n    if (!options.floatWindow) {\n      NSApp.runModalForWindow(Panel);\n    }\n\n    return result;\n  }\n\n  return {\n    createPanel: _createPanel\n  };\n})();\n","import { coerceString } from './coerce';\nimport { context } from './context';\nimport { logger } from './logger';\n\nexport const search = (function() {\n  function findLayersMatchingPredicate_inContainer_filterByType(predicate, container, layerType) {\n    var doc = context.current().document;\n    var scope;\n    switch (layerType) {\n      case MSPage:\n        scope = doc.pages();\n        return scope.filteredArrayUsingPredicate(predicate);\n    \t\tbreak;\n\n      case MSArtboardGroup:\n        if (typeof container !== 'undefined' && container != nil) {\n          if (container.className == \"MSPage\") {\n            scope = container.artboards();\n            return scope.filteredArrayUsingPredicate(predicate);\n          }\n        } else {\n          // search all pages\n          var filteredArray = NSArray.array();\n          var loopPages = doc.pages().objectEnumerator(), page;\n          while (page = loopPages.nextObject()) {\n            scope = page.artboards();\n            filteredArray = filteredArray.arrayByAddingObjectsFromArray(scope.filteredArrayUsingPredicate(predicate));\n          }\n          return filteredArray;\n        }\n    \t\tbreak;\n\n      case MSSymbolMaster:\n        scope = doc.documentData().allSymbols();\n        return scope.filteredArrayUsingPredicate(predicate);\n        break;\n\n      default:\n        if (typeof container !== 'undefined' && container != nil) {\n          scope = container.children();\n          return scope.filteredArrayUsingPredicate(predicate);\n        } else {\n          // search all pages\n          var filteredArray = NSArray.array();\n          var loopPages = doc.pages().objectEnumerator(), page;\n          while (page = loopPages.nextObject()) {\n            scope = page.children();\n            filteredArray = filteredArray.arrayByAddingObjectsFromArray(scope.filteredArrayUsingPredicate(predicate));\n          }\n          return filteredArray;\n        }\n    }\n    return NSArray.array(); // Return an empty array if no matches were found\n  }\n\n  /*function findFirstLayerMatchingPredicate_inContainer_filterByType(predicate, container, layerType) {\n    var filteredArray = findLayersMatchingPredicate_inContainer_filterByType(predicate, container, layerType);\n    return filteredArray.firstObject();\n  }\n\n  function findLayersNamed_inContainer_filterByType(layerName, container, layerType) {\n    var predicate = (typeof layerType === 'undefined' || layerType == nil) ? NSPredicate.predicateWithFormat(\"name == %@\", layerName) : NSPredicate.predicateWithFormat(\"name == %@ && class == %@\", layerName, layerType);\n    return findLayersMatchingPredicate_inContainer_filterByType(predicate, container);\n  }*/\n\n  function findPagesByName(pageName) {\n    var predicate = NSPredicate.predicateWithFormat(\"name == %@\", pageName);\n    return findLayersMatchingPredicate_inContainer_filterByType(predicate, nil, MSPage);\n  }\n\n  function findSymbolsByID(id) {\n    var predicate = NSPredicate.predicateWithFormat(\"symbolID == %@\", id);\n    return findLayersMatchingPredicate_inContainer_filterByType(predicate, nil, MSSymbolMaster);\n  }\n\n  function findSymbolsByName(name) {\n    var predicate = NSPredicate.predicateWithFormat(\"name == %@\", name);\n    return findLayersMatchingPredicate_inContainer_filterByType(predicate, nil, MSSymbolMaster);\n  }\n\n  function findSymbolsByNameBegin(name) {\n    var predicate = NSPredicate.predicateWithFormat(\"name BEGINSWITH[cd] %@\", name);\n    return findLayersMatchingPredicate_inContainer_filterByType(predicate, nil, MSSymbolMaster);\n  }\n\n  function findLayerStyleByName(styleName) {\n    var doc = context.current().document;\n\t\tvar styles = doc.documentData().layerStyles().objects();\n\n\t\tif (styles) {\n\t\t\tfor (var i = 0; i < styles.count(); i++) {\n\t\t\t\tif (styles.objectAtIndex(i).name() == styleName) {\n\t\t\t\t  return styles.objectAtIndex(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n  function findTextStyleByName(styleName) {\n    var doc = context.current().document;\n\t\tvar textStyles = doc.documentData().layerTextStyles().objects();\n\n\t\tif (textStyles) {\n\t\t\tfor (var i = 0; i < textStyles.count(); i++) {\n\t\t\t\tif (textStyles.objectAtIndex(i).name() == styleName) {\n\t\t\t\t  return textStyles.objectAtIndex(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n  function findTextStyleByID(styleID) {\n    styleID = coerceString(styleID);\n    //logger.debug(\"Looking for text style \" + styleID);\n    var doc = context.current().document;\n\t\tvar textStyles = doc.documentData().layerTextStyles().objects();\n\n\t\tif (textStyles) {\n\t\t\tfor (var i = 0; i < textStyles.count(); i++) {\n        var current = textStyles.objectAtIndex(i);\n        //logger.debug(\"  Checking text style \" + current.objectID());\n\t\t\t\tif (coerceString(current.objectID()) === styleID) {\n\t\t\t\t  return current;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n    logger.warn(\"Was looking for text style \" + styleID + \", but didn't find it.\");\n\t\treturn false;\n\t}\n\n  return {\n    findLayersMatchingPredicate_inContainer_filterByType: findLayersMatchingPredicate_inContainer_filterByType,\n    findPagesByName: findPagesByName,\n    findSymbolsByID: findSymbolsByID,\n    findSymbolsByName: findSymbolsByName,\n    findSymbolsByNameBegin: findSymbolsByNameBegin,\n    findLayerStyleByName: findLayerStyleByName,\n    findTextStyleByName: findTextStyleByName,\n    findTextStyleByID: findTextStyleByID\n  };\n})();\n","import { coerceString } from './coerce';\nimport { logger } from './logger';\nimport { search } from './search';\nimport { extend } from './util';\n\nexport const sketch = {};\n\nextend(sketch, {\n  is: function(layer, theClass) {\n    if (!layer) return false;\n    var klass = layer.class();\n    return klass === theClass;\n  },\n  addGroup: function() {\n    return MSLayerGroup.new();\n  },\n  addShape: function() {\n    return MSShapeGroup.shapeWithRect(NSMakeRect(0, 0, 100, 100));\n  },\n  addText: function(string) {\n    var text = MSTextLayer.new();\n    text.setStringValue(string || 'Text');\n    return text;\n  },\n  removeLayer: function(layer) {\n    var container = layer.parentGroup();\n    if (container) container.removeLayer(layer);\n  },\n  moveLayerAbove: function(parent, lower, upper) {\n    if (!this.is(lower, MSArtboardGroup)) {\n      upper.moveToLayer_beforeLayer(parent, lower);\n      lower.moveToLayer_beforeLayer(parent, upper);\n    }\n  },\n  setAsMask: function(layer) {\n    layer.hasClippingMask = true;\n    layer.clippingMaskMode = 0; // 0 - outline mask, 1 - alpha mask\n  },\n  setRadius: function(layer, radius) {\n    radius = '' + radius;\n    layer.layers().firstObject().setCornerRadiusFromComponents(radius);\n  },\n  getGroupRect: function(group) {\n    var rect = group.groupBoundsForLayers();\n    return {\n      x: Math.round(rect.x()),\n      y: Math.round(rect.y()),\n      width: Math.round(rect.width()),\n      height: Math.round(rect.height()),\n      maxX: Math.round(rect.x() + rect.width()),\n      maxY: Math.round(rect.y() + rect.height()),\n      setX: function(x) { rect.setX(x); this.x = x; this.maxX = this.x + this.width; },\n      setY: function(y) { rect.setY(y); this.y = y; this.maxY = this.y + this.height; },\n      setWidth: function(width) { rect.setWidth(width); this.width = width; this.maxX = this.x + this.width; },\n      setHeight: function(height) { rect.setHeight(height); this.height = height; this.maxY = this.y + this.height; }\n    };\n  },\n  getRect: function(layer) {\n    var rect = layer.frame();\n    return {\n      x: Math.round(rect.x()),\n      y: Math.round(rect.y()),\n      width: Math.round(rect.width()),\n      height: Math.round(rect.height()),\n      maxX: Math.round(rect.x() + rect.width()),\n      maxY: Math.round(rect.y() + rect.height()),\n      setX: function(x) { rect.setX(x); this.x = x; this.maxX = this.x + this.width; },\n      setY: function(y) { rect.setY(y); this.y = y; this.maxY = this.y + this.height; },\n      setWidth: function(width) { rect.setWidth(width); this.width = width; this.maxX = this.x + this.width; },\n      setHeight: function(height) { rect.setHeight(height); this.height = height; this.maxY = this.y + this.height; },\n      setConstrainProportions: function(val) { rect.setConstrainProportions(val); }\n    };\n  },\n  OVERRIDE_NULL_SYMBOL: 'NULL_SYMBOL',\n  updateOverrides: function(instance, values) {\n    var existingOverrides = instance.overrides();\n    if (!existingOverrides) { existingOverrides = NSMutableDictionary.dictionary(); }\n    var mutableOverrides = NSMutableDictionary.dictionaryWithDictionary(existingOverrides);\n\n    var idValuePairs = this._setupOverrides(instance, values);\n\n    for (var id in idValuePairs) {\n      mutableOverrides.setObject_forKey(idValuePairs[id], id);\n    }\n\n    instance.overrides = mutableOverrides;\n  },\n  _setupOverrides: function(instanceOrMaster, values) {\n    var idValuePairs = {};\n    var symbolMaster = (instanceOrMaster.className() == 'MSSymbolInstance' ? instanceOrMaster.symbolMaster() : instanceOrMaster);\n    if (symbolMaster == null) {\n      logger.error('Symbol master not found.  Make sure instance has been added to the page first.');\n    }\n    var children = symbolMaster.children();\n    for (var i = 0; i < children.count(); i++) {\n      var layer = children[i];\n      if (layer.isVisible() == 1 && layer.isLocked() == 0) {\n        var fieldNames = Object.keys(values);\n        if (layer.className() == 'MSSymbolInstance') {\n          //logger.debug('Checking overrides for symbol ' + layer.name());\n          var layerValues = values[layer.name()];\n          var layerInstanceOrMaster = layer;\n\n          var layerOverrides = {};\n\n          if (layerValues != null) {\n            var symbol = layerValues['symbolID'];\n            //logger.debug('  Symbol ' + symbol);\n            if (symbol == sketch.OVERRIDE_NULL_SYMBOL) {\n              layerOverrides['symbolID'] = \"\";\n            } else if (symbol != null) {\n              layerOverrides['symbolID'] = symbol.symbolID();\n              layerInstanceOrMaster = symbol;\n            }\n          }\n\n          var otherOverrides = this._setupOverrides(layerInstanceOrMaster, layerValues || values);\n          layerOverrides = extend(layerOverrides, otherOverrides);\n\n          /*for (var j = 0; j < fieldNames.length; j++) {\n            var fieldName = fieldNames[j];\n            if (layer.name() == fieldNames[j]) {\n              logger.debug('  Setting ' + layer.className() + ' symbolID override.');\n              layerOverrides['symbolID'] = values[fieldName].symbolID();\n              break;\n            }\n          }*/\n\n          var propertyCount = Object.keys(layerOverrides).length;\n          if (propertyCount > 0) {\n            //logger.debug('  Symbol instance overrides, adding ' + propertyCount);\n            idValuePairs[layer.objectID()] = layerOverrides;\n          }\n        } else {\n          //logger.debug('Checking overrides for layer ' + layer.name());\n          for (var j = 0; j < fieldNames.length; j++) {\n            var fieldName = fieldNames[j];\n            if (layer.name() == fieldNames[j]) {\n              //logger.debug('  Setting ' + layer.className() + ' overrides.');\n              idValuePairs[layer.objectID()] = values[fieldName];\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return idValuePairs;\n  },\n  describeOverrides: function(instance) {\n    var existingOverrides = instance.overrides();\n    return this._describeLayerOverrides('', instance, existingOverrides);\n  },\n  _describeLayerOverrides: function(indent, instance, overrides) {\n    var ret = null;\n    if (overrides != null) {\n      ret = {};\n      var symbolMaster = instance.symbolMaster();\n      var symbolId = overrides['symbolID'];\n      if (symbolId != undefined) {\n        if (symbolId == \"\") {\n          logger.debug(indent + 'Symbol removed');\n          ret['symbol'] = null;\n        } else {\n          symbolMaster = search.findSymbolsByID(symbolId)[0];\n          logger.debug(indent + 'Looked up symbol ' + symbolMaster.name());\n          ret['symbol'] = coerceString(symbolMaster.name());\n        }\n      }\n      logger.debug(indent + 'Found overrides ' + overrides.count());\n      var keys = overrides.allKeys();\n      //logger.debug('  Keys ' + keys);\n      for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var layer = null;\n        var children = symbolMaster.children();\n        for (var j = 0; j < children.count(); j++) {\n          var child = children[j];\n          logger.debug(indent + '  Checking ' + child.objectID() + ' (' + child.name() + ')');\n          if (coerceString(child.objectID()) == coerceString(key)) {\n            logger.debug(indent + '  Found layer: ' + child.name());\n            layer = child;\n            break;\n          }\n        }\n        if (layer != null) {\n          var layerOverrides = overrides.objectForKey(key);\n          logger.debug(indent + '  Layer ' + layer.className() + ' overrides ' + layerOverrides);\n          if (this.is(layer, MSSymbolInstance)) {\n            var layerDesc = this._describeLayerOverrides(indent + '  ', layer, layerOverrides);\n            if (layerDesc != null) {\n              logger.debug(indent + '    Adding map');\n              ret[layer.name()] = layerDesc;\n            }\n          } else {\n            logger.debug(indent + '    Adding ' + layerOverrides.className());\n            ret[layer.name()] = coerceString(layerOverrides);\n          }\n        }\n      }\n    }\n    return ret;\n  },\n  toNopPath: function(str) {\n    return this.toJSString(str).replace(/[\\/\\\\\\?]/g, \" \");\n  },\n  toHTMLEncode: function(str) {\n    return this.toJSString(str)\n      .replace(/\\</g, \"&lt;\")\n      .replace(/\\>/g, '&gt;')\n      .replace(/\\'/g, \"&#39;\")\n      .replace(/\\\"/g, \"&quot;\")\n      .replace(/\\u2028/g, \"\\\\u2028\")\n      .replace(/\\u2029/g, \"\\\\u2029\")\n      .replace(/\\ud83c|\\ud83d/g, \"\")\n      ;\n    // return str.replace(/\\&/g, \"&amp;\").replace(/\\\"/g, \"&quot;\").replace(/\\'/g, \"&#39;\").replace(/\\</g, \"&lt;\").replace(/\\>/g, '&gt;');\n  },\n  emojiToEntities: function(str) {\n    var emojiRanges = [\n      \"\\ud83c[\\udf00-\\udfff]\", // U+1F300 to U+1F3FF\n      \"\\ud83d[\\udc00-\\ude4f]\", // U+1F400 to U+1F64F\n      \"\\ud83d[\\ude80-\\udeff]\"  // U+1F680 to U+1F6FF\n    ];\n    return str.replace(\n      new RegExp(emojiRanges.join(\"|\"), \"g\"),\n      function(match) {\n        var c = encodeURIComponent(match).split(\"%\"),\n          h = ((parseInt(c[1], 16) & 0x0F))\n            + ((parseInt(c[2], 16) & 0x1F) << 12)\n            + ((parseInt(c[3], 16) & 0x3F) << 6)\n            + (parseInt(c[4], 16) & 0x3F);\n        return \"&#\" + h.toString() + \";\";\n      });\n  },\n  toSlug: function(str) {\n    return this.toJSString(str)\n      .toLowerCase()\n      .replace(/(<([^>]+)>)/ig, \"\")\n      .replace(/[\\/\\+\\|]/g, \" \")\n      .replace(new RegExp(\"[\\\\!@#$%^&\\\\*\\\\(\\\\)\\\\?=\\\\{\\\\}\\\\[\\\\]\\\\\\\\\\\\\\,\\\\.\\\\:\\\\;\\\\']\", \"gi\"), '')\n      .replace(/\\s+/g, '-')\n      ;\n  },\n  toJSString: function(str) {\n    return new String(str).toString();\n  },\n  toJSNumber: function(str) {\n    return Number(this.toJSString(str));\n  },\n  pointToJSON: function(point) {\n    return {\n      x: parseFloat(point.x),\n      y: parseFloat(point.y)\n    };\n  },\n  rectToJSON: function(rect, referenceRect) {\n    if (referenceRect) {\n      return {\n        x: Math.round(rect.x() - referenceRect.x()),\n        y: Math.round(rect.y() - referenceRect.y()),\n        width: Math.round(rect.width()),\n        height: Math.round(rect.height())\n      };\n    }\n\n    return {\n      x: Math.round(rect.x()),\n      y: Math.round(rect.y()),\n      width: Math.round(rect.width()),\n      height: Math.round(rect.height())\n    };\n  },\n  colorToJSON: function(color) {\n    return {\n      r: Math.round(color.red() * 255),\n      g: Math.round(color.green() * 255),\n      b: Math.round(color.blue() * 255),\n      a: color.alpha(),\n      \"color-hex\": color.immutableModelObject().stringValueWithAlpha(false) + \" \" + Math.round(color.alpha() * 100) + \"%\",\n      \"argb-hex\": \"#\" + this.toHex(color.alpha() * 255) + color.immutableModelObject().stringValueWithAlpha(false).replace(\"#\", \"\"),\n      \"css-rgba\": \"rgba(\" + [\n        Math.round(color.red() * 255),\n        Math.round(color.green() * 255),\n        Math.round(color.blue() * 255),\n        (Math.round(color.alpha() * 100) / 100)\n      ].join(\",\") + \")\",\n      \"ui-color\": \"(\" + [\n        \"r:\" + (Math.round(color.red() * 100) / 100).toFixed(2),\n        \"g:\" + (Math.round(color.green() * 100) / 100).toFixed(2),\n        \"b:\" + (Math.round(color.blue() * 100) / 100).toFixed(2),\n        \"a:\" + (Math.round(color.alpha() * 100) / 100).toFixed(2)\n      ].join(\" \") + \")\"\n    };\n  },\n  colorStopToJSON: function(colorStop) {\n    return {\n      color: this.colorToJSON(colorStop.color()),\n      position: colorStop.position()\n    };\n  },\n  gradientToJSON: function(gradient) {\n    var stopsData = [],\n      stop, stopIter = gradient.stops().objectEnumerator();\n    while (stop = stopIter.nextObject()) {\n      stopsData.push(this.colorStopToJSON(stop));\n    }\n\n    return {\n      type: GradientTypes[gradient.gradientType()],\n      from: this.pointToJSON(gradient.from()),\n      to: this.pointToJSON(gradient.to()),\n      colorStops: stopsData\n    };\n  },\n  shadowToJSON: function(shadow) {\n    return {\n      type: shadow instanceof MSStyleShadow ? \"outer\" : \"inner\",\n      offsetX: shadow.offsetX(),\n      offsetY: shadow.offsetY(),\n      blurRadius: shadow.blurRadius(),\n      spread: shadow.spread(),\n      color: this.colorToJSON(shadow.color())\n    };\n  },\n  hexToColor: function(hex) {\n    var hexRgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\n    if (hexRgb) {\n      return MSColor.colorWithRed_green_blue_alpha(parseInt(hexRgb[1], 16) / 255, parseInt(hexRgb[2], 16) / 255, parseInt(hexRgb[3], 16) / 255, 1.0);\n    } else {\n      return null;\n    }\n  },\n  getRadius: function(layer) {\n    return (layer.layers && this.is(layer.layers().firstObject(), MSRectangleShape)) ? layer.layers().firstObject().fixedRadius() : 0;\n  },\n  getBorders: function(style) {\n    var bordersData = [],\n      border, borderIter = style.borders().objectEnumerator();\n    while (border = borderIter.nextObject()) {\n      if (border.isEnabled()) {\n        var fillType = FillTypes[border.fillType()],\n          borderData = {\n            fillType: fillType,\n            position: BorderPositions[border.position()],\n            thickness: border.thickness()\n          };\n\n        switch (fillType) {\n          case \"color\":\n            borderData.color = this.colorToJSON(border.color());\n            break;\n\n          case \"gradient\":\n            borderData.gradient = this.gradientToJSON(border.gradient());\n            break;\n\n          default:\n            continue;\n        }\n\n        bordersData.push(borderData);\n      }\n    }\n\n    return bordersData;\n  },\n  getFills: function(style) {\n    var fillsData = [],\n      fill, fillIter = style.fills().objectEnumerator();\n    while (fill = fillIter.nextObject()) {\n      if (fill.isEnabled()) {\n        var fillType = FillTypes[fill.fillType()],\n          fillData = {\n            fillType: fillType\n          };\n\n        switch (fillType) {\n          case \"color\":\n            fillData.color = this.colorToJSON(fill.color());\n            break;\n\n          case \"gradient\":\n            fillData.gradient = this.gradientToJSON(fill.gradient());\n            break;\n\n          default:\n            continue;\n        }\n\n        fillsData.push(fillData);\n      }\n    }\n\n    return fillsData;\n  },\n  getShadows: function(style) {\n    var shadowsData = [],\n      shadow, shadowIter = style.shadows().objectEnumerator();\n    while (shadow = shadowIter.nextObject()) {\n      if (shadow.isEnabled()) {\n        shadowsData.push(this.shadowToJSON(shadow));\n      }\n    }\n\n    shadowIter = style.innerShadows().objectEnumerator();\n    while (shadow = shadowIter.nextObject()) {\n      if (shadow.isEnabled()) {\n        shadowsData.push(this.shadowToJSON(shaxdow));\n      }\n    }\n\n    return shadowsData;\n  },\n  getOpacity: function(style) {\n    return style.contextSettings().opacity()\n  },\n  getStyleName: function(layer) {\n    if (layer.sharedStyle()) {\n      return this.toJSString(layer.sharedStyle().name());\n    } else {\n      return \"\";\n    }\n  },\n  setColor: function(layer, color, replacementProperty) {\n    if (color) {\n      if (layer.class() == MSShapeGroup) {\n        // Shape\n        if (replacementProperty == 'Fill') {\n          var fill = layer.style().fills().firstObject();\n\n          if (fill != undefined) {\n            fill.color = color;\n          }\n        }\n\n        if (replacementProperty == 'Border') {\n          var border = layer.style().borders().firstObject();\n\n          if (border != undefined) {\n            border.color = color;\n          }\n        }\n      } else {\n        layer.textColor = color;\n      }\n    }\n  },\n  updateContext: function() {\n    this.context.document = NSDocumentController.sharedDocumentController().currentDocument();\n    this.context.selection = this.context.document.selectedLayers();\n\n    return this.context;\n  },\n  openURL: function(url){\n    var nsurl = NSURL.URLWithString(url);\n    NSWorkspace.sharedWorkspace().openURL(nsurl)\n  }\n});\n","import { logger } from './logger';\n\nexport function extend(target, options) {\n  var target = target || {};\n\n  for (var key in options) {\n    target[key] = options[key];\n  }\n  return target;\n}\n\nexport function debugObject(obj) {\n  logger.debug(JSON.stringify(obj));\n}\n","import { context } from './common/context';\nimport { logger } from './common/logger';\nimport { metadata} from './common/metadata';\nimport { panel } from './common/panel';\nimport { search } from './common/search';\nimport { sketch } from './common/sketch';\n\nexport default function(ctx) {\n  context.run(ctx, function() {\n    logger.setLevel(logger.levels.DEBUG);\n\n    Table().generateTable();\n  });\n};\n\nvar Table = function() {\n  const BORDER_WIDTH = 1;\n\n  // Parts\n  var headers,\n    columns,\n    widths,\n    metas,\n    props;\n\n  // Symbols & Groups\n  var table,\n    tableMask,\n    tableGroup;\n\n  var tableToReplace = null; // TODO\n  var layerForPositioning = null;\n\n  // Counts\n  var rowCount;\n\n  var doc = context.current().document;\n  var pageOrArtboard = doc.currentPage().currentArtboard() || doc.currentPage();\n\n  var _generateTable = function() {\n    var initialData = null;\n    var sel = context.current().selection;\n    var selCount = sel.count();\n    if (selCount == 1) {\n      if (sketch.is(sel[0], MSLayerGroup)) {\n        initialData = metadata.getConfigs(sel[0]);\n        logger.debug('loading config', initialData);\n      }\n\n      if (tableToReplace == null) { // Use for positioning\n        if (!sketch.is(sel[0], MSArtboardGroup)) {\n          layerForPositioning = sel[0];\n        }\n      }\n    }\n\n    _tablePanel(function(data) {\n      _parseDataFromPanel(data);\n      _getTableSize();\n      _createGroup();\n      _storeConfig();\n      _addPagination();\n      _addTableBase();\n      _makeCols();\n      _addGroupsToTable();\n      _positionOrReplaceTable();\n    }, initialData);\n  };\n\n  var _tablePanel = function(callback, data) {\n    return panel.createPanel({\n      url: context.getPluginRoot() + \"/Contents/Resources/panel/table.html\",\n      width: 1180,\n      height: 700,\n      data: data,\n      identifier: 'com.sketch.material.table',\n      floatWindow: false,\n      callback: callback\n    });\n  };\n\n  var _parseDataFromPanel = function(data) {\n    var _parseDataFromString = function(str, sep) {\n      return str.split(sep);\n    }\n\n    headers = _parseDataFromString(data.headers, '|');\n    columns = JSON.parse(data.cells);\n    widths = _parseDataFromString(data.widths, '|');\n    metas = _parseDataFromString(data.metas, '|');\n    props = JSON.parse(data.props);\n  };\n\n  var _getTableSize = function() {\n    rowCount = columns[0].length;\n    logger.debug('rowCount - ' + rowCount);\n  };\n\n  var _createGroup = function() {\n    tableGroup = sketch.addGroup();\n    tableGroup.setName('Table');\n  };\n\n  var _storeConfig = function() {\n    metadata.setConfigs(props, tableGroup);\n  };\n\n  var _addPagination = function() {\n    if (props.hasPagination == 'off') {\n      return;\n    }\n\n    var symbol = search.findSymbolsByName('Rivet/Table/Paging')[0];\n    var instance = symbol.newSymbolInstance();\n    instance.setName('Paging');\n\n    tableGroup.addLayers([instance]);\n\n    var rect = sketch.getRect(instance);\n    rect.setY(395);\n    rect.setX(0);\n\n    //var action = MSMoveToBackAction.alloc().init();\n    //[action moveToBack:instance];\n  };\n\n  var _addTableBase = function() {\n    tableMask = sketch.addShape();\n    tableMask.setName('Mask');\n    sketch.setAsMask(tableMask);\n    //if (props.hasShadow == 'on') {\n      //sketch.setRadius(tableMask, 0);\n      var maskStyle = search.findLayerStyleByName('Rivet Table Mask');\n      tableMask.setSharedStyle(maskStyle);\n    //}\n    var maskRect = sketch.getRect(tableMask);\n\n    var symbol = search.findSymbolsByName('Rivet/Table/Table')[0];\n    table = symbol.newSymbolInstance();\n    table.setName('Table');\n    var tableRect = sketch.getRect(table);\n\n    maskRect.setWidth(tableRect.width);\n    maskRect.setHeight(tableRect.height);\n\n    tableGroup.addLayers([tableMask, table]);\n\n    pageOrArtboard.addLayer(tableGroup);\n  };\n\n  var _makeCols = function() {\n    var x = BORDER_WIDTH;\n    var symbol = search.findSymbolsByName('Rivet/Table/Column-Dimension')[0];\n    var metricSymbol = search.findSymbolsByName('Rivet/Table/Column-Metric-Number')[0];\n    var iconSymbol = search.findSymbolsByName('Rivet/Table/Column-Icon')[0];\n\n    if (props.hasCheckboxes == 'on') {\n      var selectSymbol = search.findSymbolsByName('Rivet/Table/Column-Select')[0];\n      var instance = selectSymbol.newSymbolInstance();\n      instance.setName('Select Column');\n      tableGroup.addLayers([instance]);\n      var rect = sketch.getRect(instance);\n      rect.setX(x);\n      x += rect.width;\n    }\n\n    var tableRect = sketch.getRect(table);\n    var tableWidth = tableRect.width;\n\n    for (var i = 0; i < headers.length; i++) {\n      var header = headers[i];\n\n      var isIcon = false;\n      var uniqueValues = new Set(columns[i]);\n      uniqueValues.delete('');\n      if (uniqueValues.size == 1 && uniqueValues.has('x')) {\n        isIcon = true;\n      }\n\n      var instance = symbol.newSymbolInstance();\n      if (metas[i] == 'htRight') {\n        instance = metricSymbol.newSymbolInstance();\n      } else if (isIcon) {\n        instance = iconSymbol.newSymbolInstance();\n      }\n\n      instance.setName(header + ' Column');\n      tableGroup.addLayers([instance]);\n      sketch.moveLayerAbove(tableGroup, table, instance);\n\n      var overrideValues = {'Title': header};\n      if (i == headers.length - 1) {\n        overrideValues['Last Column'] = {'symbolID': sketch.OVERRIDE_NULL_SYMBOL};\n      }\n      for (var j = 0; j < 10; j++) {\n        var value = columns[i][j];\n        if (props.hasDefaultValues == 'off' && value == '') { value = ' '; }\n        if (isIcon && value.toLowerCase() != 'x') {\n          logger.debug('Setting icon to null for row ' + (j + 1));\n          value = {'symbolID': sketch.OVERRIDE_NULL_SYMBOL};\n        }\n        overrideValues['Row ' + (j + 1)] = value;\n      }\n      sketch.updateOverrides(instance, overrideValues);\n\n      var width = Math.round(parseInt(widths[i]) / 5) * 5;\n      if (i == headers.length - 1 && x + width < tableWidth) {\n        width = tableWidth - x - BORDER_WIDTH;\n      }\n      var columnRect = sketch.getRect(instance);\n      columnRect.setX(x);\n      columnRect.setWidth(width);\n\n      x += width;\n    }\n  };\n\n  var _addGroupsToTable = function() {\n    tableGroup.setConstrainProportions(false);\n\n    tableGroup.select_byExpandingSelection(true, true);\n  };\n\n  var _positionOrReplaceTable = function() {\n    if (tableToReplace != null) {\n      /*sketch.moveLayerAbove(pageOrArtboard, tableToReplace, list);\n      var replaceRect = sketch.getRect(tableToReplace);\n      var listRect = sketch.getRect(list);\n      listRect.setX(replaceRect.x);\n      listRect.setY(replaceRect.y);\n      listRect.setWidth(replaceRect.width);\n      list.setName(tableToReplace.name());\n      sketch.removeLayer(tableToReplace);*/\n    } else if (layerForPositioning != null) {\n      sketch.moveLayerAbove(pageOrArtboard, layerForPositioning, tableGroup);\n      var layerRect = sketch.getRect(layerForPositioning);\n      var tableGroupRect = sketch.getRect(tableGroup);\n      tableGroupRect.setX(layerRect.x);\n      tableGroupRect.setY(layerRect.y);\n    }\n\n    tableGroup.select_byExpandingSelection(true, false);\n    //tableGroup.select_byExpandingSelection(true, true);\n  };\n\n  return {\n    generateTable: function() {\n      _generateTable();\n    }\n  };\n};\n"],"sourceRoot":""}